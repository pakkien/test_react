import{r as s,u as ve,g as G,j as e,C as ie,f as le,h as re,i as ce,k as de,A as Ne,F as w,I as o,l as z,m as H,B as u,n as A,s as D,o as N,p as Ae,q as Me,t as Le,v as ze,P as ye,S as Ee,b as Ve,d as _e,w as Ie,a as Be}from"./index-BCXmo6gL.js";import{P as Ce,u as be,d as we,a as ke}from"./useSortableData-Z2JmnADG.js";import{M as ue,a as he,b as me,c as pe,d as xe}from"./Modal-C8ad1jhR.js";import{u as Pe,c as Te,t as Ue}from"./timezone-PqR3fv86.js";import{S as fe}from"./Select-BZOlqDju.js";function q(n){return n?e.jsx(o,{icon:"CheckCircleOutline",className:"",color:"success",size:"2x",forceFamily:"material"}):e.jsx(o,{icon:"Cancel",className:"",color:"danger",size:"2x",forceFamily:"material"})}const Ye=()=>{const[n,r]=s.useState([]),[x,c]=s.useState(n),C=async()=>{const a={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};A.get("undefined/users",a).then(d=>{r(d.data.data),c(d.data.data)})};s.useEffect(()=>{C()},[]);function y(a){const d={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};A.delete(`undefined/users/${a}`,d).then(O=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(o,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"User Deleted"})]}),"User deleted successfully"),C()}).catch(O=>console.log(O))}const Q=ve(),E=a=>{Q(`manage-user/${a}`)},[M,V]=s.useState({name:"",id:-99}),[_,m]=s.useState(!1),[k,p]=s.useState(!1),[W,f]=s.useState(!1),[I,B]=s.useState(!1),[b,P]=s.useState(null),[T,J]=s.useState(void 0),[K,X]=s.useState(!0),[je,Z]=s.useState(!1),[L,ee]=s.useState(!0),te=()=>{p(!1),f(!1),B(!1),P(null),J(!1),X(!0),Z(!1),ee(!0)},[U,ae]=s.useState(1),[Y,se]=s.useState(Ce[5]),{items:ne,requestSort:S,getClassNamesFor:g}=be(x),R=a=>{const d=a.search.toString().toLowerCase(),O=oe(d);a.search?c(O):c(n)},v=G({initialValues:{search:""},onSubmit:R,onReset:()=>c(n)}),oe=a=>n.filter(d=>d.name.toLowerCase().includes(a)||d.role.toLowerCase().includes(a)||d.email.toLowerCase().includes(a));return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{stretch:!0,children:[e.jsx(le,{className:"table-responsive",isScrollable:!0,children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(re,{children:e.jsx(ce,{children:e.jsx(de,{tag:"div",className:"h3",children:"Manage Users"})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(Ne,{color:"light",isLight:!0,children:e.jsx("form",{onSubmit:v.handleSubmit,children:e.jsx(w,{children:e.jsxs("div",{className:"d-flex","data-tour":"search",children:[e.jsx("label",{className:"border-0 bg-transparent",children:e.jsx(o,{icon:"Search",size:"2x",color:"primary"})}),e.jsx(z,{id:"search",placeholder:"Search...",className:"border-0 shadow-none bg-transparent",onChange:a=>{v.handleChange(a),a.target.value.length>2&&H(()=>R({...v.values,search:a.target.value}),1e3)(),a.target.value.length===0&&v.resetForm()},value:v.values.search})]})})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(u,{color:"success",className:"float-end",icon:"Create",tag:"a",isDisable:!0,children:"Create"})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("table",{className:"table table-modern",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsxs("th",{onClick:()=>S("role"),className:"cursor-pointer text-decoration-underline",children:["Role",e.jsx(o,{size:"lg",className:g("role"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("name"),className:"cursor-pointer text-decoration-underline",children:["Name",e.jsx(o,{size:"lg",className:g("name"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("email"),className:"cursor-pointer text-decoration-underline",children:["Email",e.jsx(o,{size:"lg",className:g("email"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("view_quotation"),className:"cursor-pointer text-decoration-underline",children:["View Quotation",e.jsx(o,{size:"lg",className:g("view_quotation"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("write_quotation"),className:"cursor-pointer text-decoration-underline",children:["Create / Edit Quotation",e.jsx(o,{size:"lg",className:g("write_quotation"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("view_mccr"),className:"cursor-pointer text-decoration-underline",children:["View MCCR",e.jsx(o,{size:"lg",className:g("view_mccr"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("write_mccr"),className:"cursor-pointer text-decoration-underline",children:["Create / Edit MCCR",e.jsx(o,{size:"lg",className:g("write_mccr"),icon:"FilterList"})]}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:we(ne,U,Y).map((a,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsx("td",{children:a.role}),e.jsx("td",{children:a.name}),e.jsx("td",{children:a.email}),e.jsx("td",{children:q(a.view_quotation)}),e.jsx("td",{children:q(a.write_quotation)}),e.jsx("td",{children:q(a.view_mccr)}),e.jsx("td",{children:q(a.write_mccr)}),e.jsx("td",{children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-auto",children:e.jsx(u,{color:"primary",icon:"Edit",shadow:"none",hoverShadow:"lg",tag:"a",target:"_blank",onClick:()=>E(a.id)})}),e.jsx("div",{className:"col-auto",children:e.jsx(u,{className:"me-4",color:"danger",isLight:!0,icon:"Delete",onClick:()=>{V({name:a.name,id:a.id}),te(),B(!0),m(!0)}})})]})})]},a.id))})]})})]})}),e.jsx(ke,{data:ne,label:"items",setCurrentPage:ae,currentPage:U,perPage:Y,setPerPage:se})]}),e.jsxs(ue,{isOpen:_,setIsOpen:m,titleId:"exampleModalLabel",isStaticBackdrop:k,isScrollable:W,isCentered:I,size:b,fullScreen:T,isAnimation:K,children:[e.jsx(he,{setIsOpen:L?m:void 0,children:e.jsxs(me,{id:"confirmDeleteUserModal",children:["Confirm Delete User - ",M.name]})}),e.jsxs(pe,{children:["Confirm to delete ",M.name]}),e.jsxs(xe,{children:[e.jsx(u,{color:"danger",icon:"Delete",onClick:()=>{m(!1),y(M.id)},children:"Delete"}),e.jsx(u,{color:"info",isOutline:!0,className:"border-0",onClick:()=>m(!1),children:"Cancel"})]})]})]})},Re=n=>{const r=G({initialValues:{option_name:n.option_name,option_value:n.option_value},validate:x=>{const c={};return x.option_name||(c.option_name="Required"),x.option_value||(c.option_value="Required"),c},onSubmit:async x=>{await n.handleSubmit_EditOption(n.option_id,x.option_name,x.option_value)}});return e.jsx(e.Fragment,{children:e.jsxs(ue,{isOpen:n.stateEditModal,setIsOpen:n.setStateEditModal,titleId:"EditOptionModal",isStaticBackdrop:!1,isScrollable:!1,isCentered:!1,size:null,fullScreen:!1,isAnimation:!0,children:[e.jsx(he,{setIsOpen:n.setStateEditModal,children:e.jsx(me,{id:"EditOptionModalTitleId",children:"Edit Option"})}),e.jsx(pe,{children:e.jsx("div",{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(w,{id:"option_name",label:"Option Name",isFloating:!0,children:e.jsx(z,{placeholder:"Option Name",onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.option_name,isValid:r.isValid,isTouched:r.touched.option_name,invalidFeedback:r.errors.option_name,validFeedback:"Valid Option Name"})})}),e.jsx("div",{className:"col-md-6",children:e.jsx(w,{id:"option_value",label:"Option Value",isFloating:!0,children:e.jsx(z,{placeholder:"Option Value",onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.option_value,isValid:r.isValid,isTouched:r.touched.option_value,invalidFeedback:r.errors.option_value,validFeedback:"Valid Option Value"})})}),e.jsx("div",{className:"col-md-12"})]})})}),e.jsxs(xe,{children:[e.jsx(u,{color:"info",isOutline:!0,className:"border-0",onClick:()=>n.setStateEditModal(!1),children:"Cancel"}),e.jsx(u,{color:"success",icon:"Save",onClick:()=>{n.setStateEditModal(!1),r.submitForm()},children:"Save"})]})]})})};N.extend(Pe);N.extend(Ae);N.extend(Te);N.extend(Ue);const $e=()=>{const[n,r]=s.useState([]),[x,c]=s.useState(n),C=async()=>{const t={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};A.get("undefined/option/",t).then(l=>{r(l.data.options),c(l.data.options)})};s.useEffect(()=>{C()},[]);const[y,Q]=s.useState(1),[E,M]=s.useState(Ce[5]),{items:V,requestSort:_,getClassNamesFor:m}=be(x),k=t=>{const l=t.search.toString().toLowerCase(),j=t.option_name.toString().toLowerCase(),h=W(l,j);!t.search&&!t.option_name?c(n):c(h)},p=G({initialValues:{search:"",option_name:""},onSubmit:k,onReset:()=>c(n)}),W=(t,l)=>{let j=n;return l&&(j=n.filter(h=>h.option_name.toLowerCase()===l)),j.filter(h=>h.option_name.toLowerCase().includes(t)||h.option_value.toLowerCase().includes(t)||N(`${h.created_at}`).format("DD-MM-YYYY").includes(t)||h.created_by.toLowerCase().includes(t)||N(`${h.updated_at}`).format("DD-MM-YYYY").includes(t)||h.updated_by.toLowerCase().includes(t))},[f,I]=s.useState({option_id:-99,option_name:"",option_value:""}),[B,b]=s.useState(!1),[P,T]=s.useState(!1),[J,K]=s.useState(!1),[X,je]=s.useState(!1),[Z,L]=s.useState(!1),[ee,te]=s.useState(null),[U,ae]=s.useState(void 0),[Y,se]=s.useState(!0),[ne,S]=s.useState(!1),[g,R]=s.useState(!0),v=()=>{K(!1),je(!1),L(!1),te(null),ae(!1),se(!0),S(!1),R(!0)},oe=t=>{const l={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};A.delete(`undefined/option/${t}`,l).then(j=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(o,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Option Deleted"})]}),"Option deleted successfully"),d(!1),C()}).catch(j=>console.log(j))},[a,d]=s.useState(!1),O=async(t,l)=>{const j={headers:{Authorization:`${localStorage.getItem("bts_token")}`}},h={option_name:t,option_value:l};A.post("undefined/option/",h,j).then($=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(o,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Option Added"})]}),"Option added successfully"),C(),i.resetForm()}).catch($=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(o,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Error"})]}),$)})},i=G({initialValues:{option_name_dropdown:"",option_name:"",option_value:""},validate:t=>{const l={};return!t.option_name&&!t.option_name_dropdown&&(l.option_name="Required"),t.option_value||(l.option_value="Required"),l},onSubmit:async t=>{const l=t.option_name_dropdown?t.option_name_dropdown:t.option_name;await O(l,t.option_value)}}),Oe=n.map(t=>t.option_name),Se=[...new Set(Oe)].map(t=>({value:t,text:t}));Se.splice(0,0,{value:"",text:"All Option"});var Fe=[{value:"PaymentTerms",text:"PaymentTerms"},{value:"Validity",text:"Validity"}];const De=async(t,l,j)=>{const h={headers:{Authorization:`${localStorage.getItem("bts_token")}`}},$={option_name:l,option_value:j};A.put(`undefined/option/${t}`,$,h).then(ge=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(o,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Option Updated"})]}),"Option updated successfully"),C()}).catch(ge=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(o,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Error update option"})]}),ge)})};return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{hidden:!a,tag:"form",children:[e.jsxs(re,{children:[e.jsx(ce,{children:e.jsx(de,{tag:"div",className:"h3",children:"Add Options"})}),e.jsx(Me,{children:e.jsx(u,{color:"dark",className:"float-end",icon:"Close",tag:"a",isLight:!0,onClick:()=>{i.resetForm(),d(!1),p.resetForm()}})})]}),e.jsx(le,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-2",children:e.jsx(w,{id:"option_name_dropdown",label:i.values.option_name_dropdown==""?"":"Option Name",isFloating:!0,children:e.jsx(fe,{id:"OptionNameSelect",ariaLabel:"Default select option name",value:i.values.option_name_dropdown,list:Fe,onBlur:i.handleBlur,isValid:i.isValid,isTouched:i.touched.option_name_dropdown,invalidFeedback:i.errors.option_name_dropdown,onChange:t=>{i.handleChange(t),H(()=>k({...p.values,option_name:t.target.value}),1e3)()}})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(w,{id:"option_value",label:"Option Value",isFloating:!0,children:e.jsx(z,{placeholder:"Option Value",onChange:i.handleChange,onBlur:i.handleBlur,value:i.values.option_value,isValid:i.isValid,isTouched:i.touched.option_value,invalidFeedback:i.errors.option_value,validFeedback:"Valid Option Value"})})}),e.jsx("div",{className:"col-md-12"})]})}),e.jsx(Le,{children:e.jsx(ze,{children:e.jsx(u,{color:"success",icon:"Add",tag:"a",onClick:i.handleSubmit,children:"Add"})})})]}),e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",hidden:a,children:e.jsx(re,{children:e.jsx(ce,{children:e.jsx(de,{tag:"div",className:"h3",children:"Manage Options"})})})}),e.jsx("div",{className:"col-md-2",hidden:a,children:e.jsx(w,{id:"option_name_dropdown",label:i.values.option_name_dropdown==""?"":"Option Name",isFloating:!0,children:e.jsx(fe,{id:"OptionNameSelect",ariaLabel:"Default select option name",value:i.values.option_name_dropdown,list:Se,isTouched:i.touched.option_name_dropdown,onChange:t=>{i.handleChange(t),H(()=>k({...p.values,option_name:t.target.value,search:p.values.search}),1e3)()}})})}),e.jsx("div",{className:"col-md-4",hidden:a,children:e.jsx(Ne,{color:"light",isLight:!0,children:e.jsx("form",{onSubmit:p.handleSubmit,children:e.jsx(w,{children:e.jsxs("div",{className:"d-flex","data-tour":"search",children:[e.jsx("label",{className:"border-0 bg-transparent",children:e.jsx(o,{icon:"Search",size:"2x",color:"primary"})}),e.jsx(z,{id:"search",placeholder:"Search...",className:"border-0 shadow-none bg-transparent",onChange:t=>{p.handleChange(t),t.target.value.length>2&&H(()=>k({...p.values,search:t.target.value,option_name:i.values.option_name_dropdown}),1e3)(),t.target.value.length===0&&p.resetForm()},value:p.values.search})]})})})})}),e.jsx("div",{className:"col-md-3",hidden:a,children:e.jsx(u,{color:"primary",className:"float-end",icon:"Add",tag:"a",onClick:()=>{d(!0),p.resetForm(),i.resetForm()},children:"Add"})}),e.jsx("div",{className:"col-md-12"}),e.jsx("div",{className:"col-md-12",children:e.jsxs("table",{className:"table table-modern",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsxs("th",{onClick:()=>_("option_name"),className:"cursor-pointer text-decoration-underline",children:["Option Name",e.jsx(o,{size:"lg",className:m("option_name"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("option_value"),className:"cursor-pointer text-decoration-underline",children:["Option Value",e.jsx(o,{size:"lg",className:m("option_value"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("created_at"),className:"cursor-pointer text-decoration-underline",children:["Created At",e.jsx(o,{size:"lg",className:m("created_at"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("created_by"),className:"cursor-pointer text-decoration-underline",children:["Created By",e.jsx(o,{size:"lg",className:m("created_by"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("updated_at"),className:"cursor-pointer text-decoration-underline",children:["Updated At",e.jsx(o,{size:"lg",className:m("updated_at"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("updated_by"),className:"cursor-pointer text-decoration-underline",children:["Updated By",e.jsx(o,{size:"lg",className:m("updated_by"),icon:"FilterList"})]}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:we(V,y,E).map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:t.option_name}),e.jsx("td",{children:t.option_value}),e.jsx("td",{children:N.utc(`${t.created_at}`).local().format("DD-MM-YYYY HH:mm:ss")}),e.jsx("td",{children:t.created_by}),e.jsx("td",{children:N.utc(`${t.updated_at}`).local().format("DD-MM-YYYY HH:mm:ss")}),e.jsx("td",{children:t.updated_by}),e.jsxs("td",{children:[e.jsx(u,{className:"me-4",color:"primary",isLight:!0,icon:"Edit",onClick:()=>{I({option_id:t.option_id,option_name:t.option_name,option_value:t.option_value}),v(),L(!0),T(!0)}}),e.jsx(u,{className:"me-4",color:"danger",isLight:!0,icon:"Delete",onClick:()=>{I({option_id:t.option_id,option_name:t.option_name,option_value:t.option_value}),v(),L(!0),b(!0)}})]})]},t.option_id))})]})})]})}),e.jsx(ke,{data:V,label:"items",setCurrentPage:Q,currentPage:y,perPage:E,setPerPage:M})]}),e.jsxs(ue,{isOpen:B,setIsOpen:b,titleId:"exampleModalLabel",isStaticBackdrop:J,isScrollable:X,isCentered:Z,size:ee,fullScreen:U,isAnimation:Y,children:[e.jsx(he,{setIsOpen:g?b:void 0,children:e.jsx(me,{id:"confirmDeleteUserModal",children:"Confirm Delete:"})}),e.jsx(pe,{children:e.jsxs("p",{children:["Option Name: ",f.option_name," ",e.jsx("br",{})," Option Value:"," ",f.option_value]})}),e.jsxs(xe,{children:[e.jsx(u,{color:"danger",icon:"Delete",onClick:()=>{b(!1),oe(f.option_id)},children:"Delete"}),e.jsx(u,{color:"info",isOutline:!0,className:"border-0",onClick:()=>b(!1),children:"Cancel"})]})]}),P&&e.jsx(Re,{option_id:f.option_id,option_name:f.option_name,option_value:f.option_value,stateEditModal:P,setStateEditModal:T,handleSubmit_EditOption:De})]})},F={MANAGE_USERS:"Manage Users",MANAGE_OPTIONS:"Manage Options"},Ke=()=>{const[n,r]=s.useState(F.MANAGE_USERS),x=ve();return e.jsxs(ye,{title:"Admin",children:[e.jsx(Ee,{children:e.jsxs(Ve,{children:[e.jsx(u,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>x(-1),children:"Back"}),e.jsx(_e,{}),e.jsx("strong",{className:"fs-5",children:"Admin"}),e.jsx(_e,{}),e.jsx(Ie,{children:Object.keys(F).map(c=>e.jsx(u,{color:n===F[c]?"success":"light",onClick:()=>r(F[c]),children:F[c]},c))})]})}),e.jsx(Be,{container:"fluid",children:n==F.MANAGE_USERS?e.jsx(Ye,{}):e.jsx($e,{})})]})};export{Ke as default};
