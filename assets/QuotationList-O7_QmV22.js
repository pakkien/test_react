import{G as K,H as tt,v as k,J as ft,u as mt,r as q,g as xt,j as s,P as vt,S as gt,b as pt,B as Q,d as jt,a as $t,A as at,C as Dt,f as St,h as wt,i as Ct,k as Mt,F as Yt,I as nt,l as Lt,m as bt,K as yt}from"./index-B2HJiTi2.js";import{B as Ot}from"./Badge-Dgohm67U.js";import{P as Tt,u as Nt,d as zt,a as Ft}from"./useSortableData-sbBQkcj_.js";import"./Select-BBbRxwGA.js";var rt={exports:{}};(function(D,H){(function(M,j){D.exports=j()})(K,function(){var M="minute",j=/[+-]\d\d(?::?\d\d)?/g,N=/([+-]|\d\d)/g;return function(Y,u,g){var c=u.prototype;g.utc=function(a){var t={date:a,utc:!0,args:arguments};return new u(t)},c.utc=function(a){var t=g(this.toDate(),{locale:this.$L,utc:!0});return a?t.add(this.utcOffset(),M):t},c.local=function(){return g(this.toDate(),{locale:this.$L,utc:!1})};var L=c.parse;c.parse=function(a){a.utc&&(this.$u=!0),this.$utils().u(a.$offset)||(this.$offset=a.$offset),L.call(this,a)};var h=c.init;c.init=function(){if(this.$u){var a=this.$d;this.$y=a.getUTCFullYear(),this.$M=a.getUTCMonth(),this.$D=a.getUTCDate(),this.$W=a.getUTCDay(),this.$H=a.getUTCHours(),this.$m=a.getUTCMinutes(),this.$s=a.getUTCSeconds(),this.$ms=a.getUTCMilliseconds()}else h.call(this)};var y=c.utcOffset;c.utcOffset=function(a,t){var n=this.$utils().u;if(n(a))return this.$u?0:n(this.$offset)?y.call(this):this.$offset;if(typeof a=="string"&&(a=function(e){e===void 0&&(e="");var i=e.match(j);if(!i)return null;var x=(""+i[0]).match(N)||["-",0,0],p=x[0],v=60*+x[1]+ +x[2];return v===0?0:p==="+"?v:-v}(a),a===null))return this;var o=Math.abs(a)<=16?60*a:a,r=this;if(t)return r.$offset=o,r.$u=a===0,r;if(a!==0){var f=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(r=this.local().add(o+f,M)).$offset=o,r.$x.$localOffset=f}else r=this.utc();return r};var l=c.format;c.format=function(a){var t=a||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},c.valueOf=function(){var a=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*a},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var m=c.toDate;c.toDate=function(a){return a==="s"&&this.$offset?g(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var d=c.diff;c.diff=function(a,t,n){if(a&&this.$u===a.$u)return d.call(this,a,t,n);var o=this.local(),r=g(a).local();return d.call(o,r,t,n)}}})})(rt);var Pt=rt.exports;const qt=tt(Pt);var ot={exports:{}};(function(D,H){(function(M,j){D.exports=j()})(K,function(){var M={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},j=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,N=/\d/,Y=/\d\d/,u=/\d\d?/,g=/\d*[^-_:/,()\s\d]+/,c={},L=function(t){return(t=+t)+(t>68?1900:2e3)},h=function(t){return function(n){this[t]=+n}},y=[/[+-]\d\d:?(\d\d)?|Z/,function(t){(this.zone||(this.zone={})).offset=function(n){if(!n||n==="Z")return 0;var o=n.match(/([+-]|\d\d)/g),r=60*o[1]+(+o[2]||0);return r===0?0:o[0]==="+"?-r:r}(t)}],l=function(t){var n=c[t];return n&&(n.indexOf?n:n.s.concat(n.f))},m=function(t,n){var o,r=c.meridiem;if(r){for(var f=1;f<=24;f+=1)if(t.indexOf(r(f,0,n))>-1){o=f>12;break}}else o=t===(n?"pm":"PM");return o},d={A:[g,function(t){this.afternoon=m(t,!1)}],a:[g,function(t){this.afternoon=m(t,!0)}],Q:[N,function(t){this.month=3*(t-1)+1}],S:[N,function(t){this.milliseconds=100*+t}],SS:[Y,function(t){this.milliseconds=10*+t}],SSS:[/\d{3}/,function(t){this.milliseconds=+t}],s:[u,h("seconds")],ss:[u,h("seconds")],m:[u,h("minutes")],mm:[u,h("minutes")],H:[u,h("hours")],h:[u,h("hours")],HH:[u,h("hours")],hh:[u,h("hours")],D:[u,h("day")],DD:[Y,h("day")],Do:[g,function(t){var n=c.ordinal,o=t.match(/\d+/);if(this.day=o[0],n)for(var r=1;r<=31;r+=1)n(r).replace(/\[|\]/g,"")===t&&(this.day=r)}],w:[u,h("week")],ww:[Y,h("week")],M:[u,h("month")],MM:[Y,h("month")],MMM:[g,function(t){var n=l("months"),o=(l("monthsShort")||n.map(function(r){return r.slice(0,3)})).indexOf(t)+1;if(o<1)throw new Error;this.month=o%12||o}],MMMM:[g,function(t){var n=l("months").indexOf(t)+1;if(n<1)throw new Error;this.month=n%12||n}],Y:[/[+-]?\d+/,h("year")],YY:[Y,function(t){this.year=L(t)}],YYYY:[/\d{4}/,h("year")],Z:y,ZZ:y};function a(t){var n,o;n=t,o=c&&c.formats;for(var r=(t=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function($,S,b){var C=b&&b.toUpperCase();return S||o[b]||M[b]||o[C].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(O,T,z){return T||z.slice(1)})})).match(j),f=r.length,e=0;e<f;e+=1){var i=r[e],x=d[i],p=x&&x[0],v=x&&x[1];r[e]=v?{regex:p,parser:v}:i.replace(/^\[|\]$/g,"")}return function($){for(var S={},b=0,C=0;b<f;b+=1){var O=r[b];if(typeof O=="string")C+=O.length;else{var T=O.regex,z=O.parser,U=$.slice(C),P=T.exec(U)[0];z.call(S,P),$=$.replace(P,"")}}return function(F){var A=F.afternoon;if(A!==void 0){var w=F.hours;A?w<12&&(F.hours+=12):w===12&&(F.hours=0),delete F.afternoon}}(S),S}}return function(t,n,o){o.p.customParseFormat=!0,t&&t.parseTwoDigitYear&&(L=t.parseTwoDigitYear);var r=n.prototype,f=r.parse;r.parse=function(e){var i=e.date,x=e.utc,p=e.args;this.$u=x;var v=p[1];if(typeof v=="string"){var $=p[2]===!0,S=p[3]===!0,b=$||S,C=p[2];S&&(C=p[2]),c=this.$locale(),!$&&C&&(c=o.Ls[C]),this.$d=function(U,P,F,A){try{if(["x","X"].indexOf(P)>-1)return new Date((P==="X"?1e3:1)*U);var w=a(P)(U),B=w.year,E=w.month,ct=w.day,ut=w.hours,lt=w.minutes,dt=w.seconds,ht=w.milliseconds,et=w.zone,st=w.week,I=new Date,R=ct||(B||E?1:I.getDate()),V=B||I.getFullYear(),Z=0;B&&!E||(Z=E>0?E-1:I.getMonth());var _,G=ut||0,W=lt||0,X=dt||0,J=ht||0;return et?new Date(Date.UTC(V,Z,R,G,W,X,J+60*et.offset*1e3)):F?new Date(Date.UTC(V,Z,R,G,W,X,J)):(_=new Date(V,Z,R,G,W,X,J),st&&(_=A(_).week(st).toDate()),_)}catch{return new Date("")}}(i,v,x,o),this.init(),C&&C!==!0&&(this.$L=this.locale(C).$L),b&&i!=this.format(v)&&(this.$d=new Date("")),c={}}else if(v instanceof Array)for(var O=v.length,T=1;T<=O;T+=1){p[1]=v[T-1];var z=o.apply(this,p);if(z.isValid()){this.$d=z.$d,this.$L=z.$L,this.init();break}T===O&&(this.$d=new Date(""))}else f.call(this,e)}}})})(ot);var kt=ot.exports;const Ht=tt(kt);var it={exports:{}};(function(D,H){(function(M,j){D.exports=j()})(K,function(){var M={year:0,month:1,day:2,hour:3,minute:4,second:5},j={};return function(N,Y,u){var g,c=function(l,m,d){d===void 0&&(d={});var a=new Date(l),t=function(n,o){o===void 0&&(o={});var r=o.timeZoneName||"short",f=n+"|"+r,e=j[f];return e||(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:r}),j[f]=e),e}(m,d);return t.formatToParts(a)},L=function(l,m){for(var d=c(l,m),a=[],t=0;t<d.length;t+=1){var n=d[t],o=n.type,r=n.value,f=M[o];f>=0&&(a[f]=parseInt(r,10))}var e=a[3],i=e===24?0:e,x=a[0]+"-"+a[1]+"-"+a[2]+" "+i+":"+a[4]+":"+a[5]+":000",p=+l;return(u.utc(x).valueOf()-(p-=p%1e3))/6e4},h=Y.prototype;h.tz=function(l,m){l===void 0&&(l=g);var d,a=this.utcOffset(),t=this.toDate(),n=t.toLocaleString("en-US",{timeZone:l}),o=Math.round((t-new Date(n))/1e3/60),r=15*-Math.round(t.getTimezoneOffset()/15)-o;if(!Number(r))d=this.utcOffset(0,m);else if(d=u(n,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(r,!0),m){var f=d.utcOffset();d=d.add(a-f,"minute")}return d.$x.$timezone=l,d},h.offsetName=function(l){var m=this.$x.$timezone||u.tz.guess(),d=c(this.valueOf(),m,{timeZoneName:l}).find(function(a){return a.type.toLowerCase()==="timezonename"});return d&&d.value};var y=h.startOf;h.startOf=function(l,m){if(!this.$x||!this.$x.$timezone)return y.call(this,l,m);var d=u(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return y.call(d,l,m).tz(this.$x.$timezone,!0)},u.tz=function(l,m,d){var a=d&&m,t=d||m||g,n=L(+u(),t);if(typeof l!="string")return u(l).tz(t);var o=function(i,x,p){var v=i-60*x*1e3,$=L(v,p);if(x===$)return[v,x];var S=L(v-=60*($-x)*1e3,p);return $===S?[v,$]:[i-60*Math.min($,S)*1e3,Math.max($,S)]}(u.utc(l,a).valueOf(),n,t),r=o[0],f=o[1],e=u(r).utcOffset(f);return e.$x.$timezone=t,e},u.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},u.tz.setDefault=function(l){g=l}}})})(it);var Ut=it.exports;const At=tt(Ut);k.extend(qt);k.extend(ft);k.extend(Ht);k.extend(At);function Et(D){switch(D.toLowerCase()){case"in progress":return"danger";case"closed":return"dark";case"awarded":return"success";default:return"primary"}}const Rt=()=>{const D=mt(),[H,M]=q.useState(!1),[j,N]=q.useState([]),[Y,u]=q.useState([]),g=async()=>{const e={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};yt.get("http://127.0.0.1:5000/quotation/all_quotations_table",e).then(i=>{N(i.data.quotations),u(i.data.quotations)})};q.useEffect(()=>{g()},[]);const[c,L]=q.useState(1),[h,y]=q.useState(Tt[5]),{items:l,requestSort:m,getClassNamesFor:d}=Nt(Y),a=e=>{const i=e.search.toString().toLowerCase(),x=n(i);e.search?u(x):u(j)},t=xt({initialValues:{search:""},onSubmit:a,onReset:()=>u(j)}),n=e=>j.filter(i=>i.prepared_by.toLowerCase().includes(e)||i.client.toLowerCase().includes(e)||k(`${i.quotation_date}`).format("DD-MM-YYYY").includes(e)||i.quotation_no.toLowerCase().includes(e)||i.end_user.toLowerCase().includes(e)||i.revision.toString().toLowerCase().includes(e)||i.quotation_amount.toFixed(2).toString().toLowerCase().includes(e)||i.cost.toFixed(2).toString().toLowerCase().includes(e)||i.margin.toFixed(2).toString().toLowerCase().includes(e)||i.status.toLowerCase().includes(e)||i.site_location.toLowerCase().includes(e)||i.building.toLowerCase().includes(e)),o=e=>{D("view-quotation",{state:{quotation_rev_id:e}})},r=(e,i)=>{D("edit-quotation",{state:{quotation_id:e,quotation_rev_id:i}})},f=()=>{D("create-quotation")};return s.jsxs(vt,{title:"Quotation",children:[s.jsx(gt,{children:s.jsxs(pt,{children:[s.jsx(Q,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>D(-1),children:"Back"}),s.jsx(jt,{}),s.jsx("strong",{className:"fs-5",children:"Quotation"})]})}),s.jsxs($t,{container:"fluid",children:[H&&s.jsx(at,{color:"success",isLight:!0,icon:"Create",isDismissible:!0,children:"Create Success"}),s.jsxs(Dt,{stretch:!0,children:[s.jsx(St,{className:"table-responsive",isScrollable:!0,children:s.jsxs("div",{className:"row g-4",children:[s.jsx("div",{className:"col-md-4",children:s.jsx(wt,{children:s.jsx(Ct,{children:s.jsx(Mt,{tag:"div",className:"h3",children:"Quotation"})})})}),s.jsx("div",{className:"col-md-4",children:s.jsx(at,{color:"light",isLight:!0,children:s.jsx("form",{onSubmit:t.handleSubmit,children:s.jsx(Yt,{children:s.jsxs("div",{className:"d-flex","data-tour":"search",children:[s.jsx("label",{className:"border-0 bg-transparent",children:s.jsx(nt,{icon:"Search",size:"2x",color:"primary"})}),s.jsx(Lt,{id:"search",placeholder:"Search...",className:"border-0 shadow-none bg-transparent",onChange:e=>{t.handleChange(e),e.target.value.length>2&&bt(()=>a({...t.values,search:e.target.value}),1e3)(),e.target.value.length===0&&t.resetForm()},value:t.values.search})]})})})})}),s.jsx("div",{className:"col-md-4",children:s.jsx(Q,{color:"success",className:"float-end",icon:"Create",tag:"a",onClick:()=>f(),children:"Create"})}),s.jsx("div",{className:"col-md-12",children:s.jsxs("table",{className:"table table-modern",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No."}),s.jsx("th",{children:"Prepared By"}),s.jsx("th",{children:"Client"}),s.jsxs("th",{onClick:()=>m("quotation_date"),className:"cursor-pointer text-decoration-underline",children:["Quotation Date",s.jsx(nt,{size:"lg",className:d("quotation_date"),icon:"FilterList"})]}),s.jsx("th",{children:"Quotation No."}),s.jsx("th",{children:"End User"}),s.jsx("th",{children:"Revision"}),s.jsx("th",{children:"Quotation Amount"}),s.jsx("th",{children:"Cost"}),s.jsx("th",{children:"Margin"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Site Location"}),s.jsx("th",{children:"Building"}),s.jsx("th",{children:"Action"})]})}),s.jsx("tbody",{children:zt(l,c,h).map((e,i)=>s.jsxs("tr",{children:[s.jsx("td",{children:i+1}),s.jsx("td",{children:e.prepared_by}),s.jsx("td",{children:e.client}),s.jsx("td",{children:k.utc(`${e.quotation_date}`).local().format("DD-MM-YYYY HH:mm:ss")}),s.jsx("td",{children:e.quotation_no}),s.jsx("td",{children:e.end_user}),s.jsx("td",{children:e.revision}),s.jsx("td",{children:e.quotation_amount.toFixed(2)}),s.jsx("td",{children:e.cost.toFixed(2)}),s.jsx("td",{children:e.margin.toFixed(2)}),s.jsx("td",{children:s.jsx(Ot,{className:"statusBadge",color:Et(e.status),children:s.jsx("h6",{children:e.status})})}),s.jsx("td",{children:e.site_location}),s.jsx("td",{children:e.building}),s.jsx("td",{children:s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-auto",children:s.jsx(Q,{color:"primary",icon:"RemoveRedEye",shadow:"none",hoverShadow:"lg",tag:"a",onClick:()=>o(e.quotation_rev_id)})}),s.jsx("div",{className:"col-auto",children:s.jsx(Q,{color:"primary",icon:"Edit",shadow:"none",hoverShadow:"lg",tag:"a",onClick:()=>r(e.quotation_id,e.quotation_rev_id)})})]})})]},e.id))})]})})]})}),s.jsx(Ft,{data:l,label:"items",setCurrentPage:L,currentPage:c,perPage:h,setPerPage:y})]})]})]})};export{Rt as default};
