import{r,n as S,j as e,M,o as f,p as ie,u as te,C,h as A,i as z,k as P,f as F,I,x as Q,B as w,t as D,g as oe,s as Y,F as o,l as c,v as ce,P as re,S as he,b as me,d as K,e as ue,a as xe,N as X,O as Z,Q as ee,R as U,z as je}from"./index-a5iBR9o4.js";import{f as J,p as se,u as ve,P as _e,N as ge,a as q}from"./Progress-DeSwr0Ki.js";import{Q as H,B as ae}from"./enumQuotationStatus-BXnipWh0.js";import{u as ne,c as le,t as de}from"./timezone-BCgJr9Py.js";const Ne=n=>{const[a,v]=r.useState([]),[b,t]=r.useState([]),l=async(h,_)=>{const N={headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{variance:`${_}`}};S.get(`undefined/quotation/revisions/${h}`,N).then(s=>{v(s.data.data)})};r.useEffect(()=>{l(n.quotation_id,n.variance),a.map(h=>g(h.quotation_revision_id))},[a.length]);const g=async h=>{const _={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};S.get(`undefined/quotation/${h}/attachments`,_).then(N=>{if(N.data.attachments){const s=Object.assign({data:a.filter(k=>k.quotation_revision_id==h)[0],attachment_list:N.data.attachments});b==null||b.push(s)}})},y=async(h,_)=>{S.get(`undefined/quotation/attachment/${h}`,{responseType:"blob",headers:{Authorization:`${localStorage.getItem("bts_token")}`}}).then(N=>{J(N.data,_)})};return e.jsx(e.Fragment,{children:b.map((h,_)=>e.jsxs("div",{children:[e.jsxs("a",{href:"/quotation/view/"+h.data.quotation_revision_id,target:"_blank",children:["Revision ",h.data.revision]}),e.jsx("br",{}),h.attachment_list&&h.attachment_list.map(N=>e.jsxs("li",{children:[e.jsx("span",{onClick:()=>y(N.id,N.filename),children:e.jsx(M,{title:N.filename,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:N.filename})})}),e.jsx("br",{})]}))]},_))})};f.extend(ne);f.extend(ie);f.extend(le);f.extend(de);const pe=n=>{te();const[a,v]=r.useState([]),b=async(l,g)=>{const y={headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{variance:`${g}`}};S.get(`undefined/quotation/revisions/${l}`,y).then(h=>{v(h.data.data)})};r.useEffect(()=>{b(n.quotation_id,n.variance)},[]);const t=l=>f.utc(l).local().format("YYYY-MMM-DD HH:mm:ss");return e.jsx(e.Fragment,{children:a.map(l=>e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:"/quotation/view/"+l.quotation_revision_id,target:"_blank",children:["Revision ",l.revision]})," - Created at: ",t(l.created_at),e.jsx("br",{})]}))})},W=10,G=n=>{const[a,v]=r.useState([]);r.useEffect(()=>{v(n.attachment_list)},[n.attachment_list]);const b=async(i,m,x)=>{S.get(`undefined/tracking_list/attachment/${i}/${m}`,{responseType:"blob",headers:{Authorization:`${localStorage.getItem("bts_token")}`}}).then(j=>{J(j.data,x)})},t=i=>{let m=a.filter(x=>x.id!=i);v(m)},[l,g]=r.useState([]),[y,h]=r.useState([]),[_,N]=r.useState(!1),s=async i=>{var m=new FormData;m.append("file",i);var x={onUploadProgress:function(j){const V=j.total&&j.loaded?Math.round(j.loaded*100/j.total):0;g(T=>{const B=[...T];return B.map(E=>E.name==i.name?E.upload_percent=V:null),B})},headers:{Authorization:`${localStorage.getItem("bts_token")}`}};S.post(`undefined/tracking_list/attachment/${n.attachment_type}`,m,x).then(function(j){const V=j.data.attachment_id;g(T=>{const B=[...T];return B.map(E=>E.name==i.name?E.upload_id=V:null),B})}).catch(function(j){g(V=>{const T=[...V];return T.map(B=>B.name==i.name?B.upload_error="Error":null),T})})},k=r.useCallback((i,m)=>{i!=null&&i.length&&(g(x=>[...x,...i.map(j=>Object.assign(j,{preview:se,upload_percent:0,upload_id:"",upload_error:""}))]),i.map(x=>s(x))),m!=null&&m.length&&h(x=>[...x,...m])},[]),{getRootProps:R,getInputProps:d,isDragActive:p}=ve({accept:{"application/*":[".pdf"]},maxSize:1024*1500,maxFiles:W-l.length,disabled:_,onDrop:k});r.useEffect(()=>()=>l.forEach(i=>URL.revokeObjectURL(i.preview)),[l]),r.useEffect(()=>{let m=l.filter(j=>j.upload_percent==100&&j.upload_id&&!j.upload_error).map(j=>j.upload_id),x=a.map(j=>j.id);n.setAttachmentIds([...m,...x],n.attachment_type)},[l,a]),r.useEffect(()=>{l.length+a.length>=W?N(!0):N(!1)},[l.length+a.length]);const u=i=>{g(m=>m.filter(x=>x.name!==i))},O=i=>{h(m=>m.filter(({file:x})=>x.name!==i))},L=()=>{g([]),h([])};function $(i,m=2){if(!+i)return"0 Bytes";const x=1024,j=m<0?0:m,V=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],T=Math.floor(Math.log(i)/Math.log(x));return`${parseFloat((i/Math.pow(x,T)).toFixed(j))} ${V[T]}`}return e.jsxs(C,{shadow:"none",borderSize:0,borderColor:"light",children:[e.jsx(A,{children:e.jsx(z,{children:e.jsxs(P,{tag:"div",className:"h5",children:["Attachments"," ",l!=null&&l.length||a!=null&&a.length?" - "+((l==null?void 0:l.length)+(a==null?void 0:a.length))+"/"+W:""]})})}),e.jsx(F,{className:"pb-0",children:e.jsxs("div",{className:"row g-4 ",children:[e.jsxs("div",{hidden:_,...R({className:n.className}),children:[e.jsx("input",{...d()}),e.jsx("div",{className:"border border-2 border-light border d-flex justify-content-center align-items-center",style:{height:150},children:e.jsxs("p",{className:"lead",children:[e.jsx(I,{icon:"Upload",size:"2x"}),p?"Drop the files here ...":"Drag & drop files here, or click to select files"]})})]}),a.map(i=>{var m;return e.jsx("div",{className:"col-xl-3 col-lg-6 col-md-12",children:e.jsx(C,{borderColor:"success",className:"shadow-none border border-2 rounded-2",children:e.jsx(F,{children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col d-flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"ratio ratio-1x1",style:{width:60},children:e.jsx("div",{className:Q("d-flex align-items-center justify-content-center","overflow-hidden"),children:e.jsx("img",{src:se,alt:i.filename,width:50})})})})}),e.jsx("div",{className:"flex-grow-1 ms-3 d-flex justify-content-between",children:e.jsx("div",{className:"w-100",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"fw-bold text-truncate",style:{maxWidth:"10rem"},onClick:()=>b(n.attachment_type,i.id,i.filename),children:e.jsx(M,{title:i.filename,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:i.filename})})}),e.jsx("div",{})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:(m=i.filename.split(".").pop())==null?void 0:m.toUpperCase()})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:$(i.size)})})]})})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"float-end",children:e.jsx(w,{color:"dark",isLight:!0,icon:"Close",size:"sm",rounded:1,onClick:()=>t(i.id)})})})})]})})})})},i.id)}),l.map(i=>e.jsx("div",{className:"col-xl-3 col-lg-6 col-md-12",children:e.jsx(C,{borderColor:i.upload_error?"danger":i.upload_percent!=100?"info":"success",className:"shadow-none border border-2 rounded-2",children:e.jsx(F,{children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col d-flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"ratio ratio-1x1",style:{width:60},children:e.jsx("div",{className:Q("d-flex align-items-center justify-content-center","overflow-hidden"),children:e.jsx("img",{src:i.preview,alt:i.name,width:50,onLoad:()=>{URL.revokeObjectURL(i.preview)}})})})})}),e.jsx("div",{className:"flex-grow-1 ms-3 d-flex justify-content-between",children:e.jsx("div",{className:"w-100",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"fw-bold text-truncate",style:{maxWidth:"10rem"},children:e.jsx(M,{title:i.name,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:i.name})})}),e.jsx("div",{})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:i.type})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:$(i.size)})}),e.jsx("div",{className:"col-12",children:i.upload_error?e.jsx("div",{className:"text-danger",children:i.upload_error}):i.upload_percent!=100?e.jsx(_e,{isAnimated:!0,value:i.upload_percent,max:100,color:"success",height:"0.5rem"}):e.jsxs("div",{className:"text-success",children:[e.jsx(I,{icon:"Check",size:"lg",color:"success"})," ","Uploaded"]})})]})})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"float-end",children:e.jsx(w,{color:"dark",isLight:!0,icon:"Close",size:"sm",rounded:1,onClick:()=>u(i.name)})})})})]})})})})},i.name)),y.map(({file:i,errors:m})=>e.jsx("div",{className:"col-xl-3 col-lg-6 col-md-12",children:e.jsx(C,{borderColor:"danger",className:"shadow-none border border-2 rounded-2",children:e.jsx(F,{children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col d-flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"ratio ratio-1x1",style:{width:60},children:e.jsx("div",{className:Q("d-flex align-items-center justify-content-center","overflow-hidden"),children:e.jsx(I,{icon:"ErrorOutline",size:"4x",color:"danger"})})})})}),e.jsx("div",{className:"flex-grow-1 ms-3 d-flex justify-content-between",children:e.jsx("div",{className:"w-100",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"fw-bold text-truncate",style:{maxWidth:"10rem"},children:e.jsx(M,{title:i.name,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:i.name})})}),e.jsx("div",{})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:i.type})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:$(i.size)})}),e.jsx("div",{className:"col-12",children:m.map(x=>e.jsx("div",{className:"text-danger",children:x.message}))})]})})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"float-end",children:e.jsx(w,{color:"dark",isLight:!0,icon:"Close",size:"sm",rounded:1,onClick:()=>O(i.name)})})})})]})})})})})),e.jsx("div",{children:e.jsx(w,{color:"danger",icon:"Delete",tag:"a",hidden:!(l.length>0||y.length>0),onClick:L,isLight:!0,children:"Remove all files"})})]})}),e.jsx(D,{children:e.jsx(e.Fragment,{})})]})};f.extend(ne);f.extend(ie);f.extend(le);f.extend(de);const be=n=>{const[a,v]=r.useState(),[b,t]=r.useState([]),[l,g]=r.useState([]),[y,h]=r.useState([]),_=(d,p)=>{switch(p){case"purchase_order":{t(d);break}case"sale_order":{g(d);break}case"invoice":{h(d);break}}},N=async d=>{const p={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};S.get(`undefined/tracking_list/quotation/${d}`,p).then(u=>{console.log(u.data),v(u.data)})};r.useEffect(()=>{n.quotation_id&&N(n.quotation_id)},[]);const s=oe({initialValues:{po_no:a?a.purchase_order.po_no:"",po_date:a?f.utc(`${a.purchase_order.po_date}`).local().format("YYYY-MM-DD"):"",po_amount:a?a.purchase_order.po_amount:"",so_no:a?a.sale_order.so_no:"",so_date:a?f.utc(`${a.sale_order.so_date}`).local().format("YYYY-MM-DD"):"",invoice_no:a?a.invoice.invoice_no:"",invoice_date:a?f.utc(`${a.invoice.invoice_date}`).local().format("YYYY-MM-DD"):"",payment_terms:a?a.invoice.payment_terms:"",invoice_amount:a?a.invoice.invoice_amount:"",remarks:a?a.remarks:"",status_overwrite:a?a.status_overwrite:""},enableReinitialize:!0,validate:d=>({}),onSubmit:async d=>{const p=Object.assign({quotation_id:n.quotation_id,remarks:d.remarks,status_overwrite:d.status_overwrite,purchase_order:{po_no:d.po_no,po_date:k(d.po_date),po_amount:d.po_amount,attachments:b},sale_order:{so_no:d.so_no,so_date:k(d.so_date),attachments:l},invoice:{invoice_no:d.invoice_no,invoice_date:k(d.invoice_date),invoice_amount:d.invoice_amount,payment_terms:d.payment_terms,attachments:y}});console.log(JSON.stringify(p)),R(p)}}),k=(d,p="YYYY-MM-DD",u=f.tz.guess())=>f.tz(d,p,u).utc().format("YYYY-MM-DDTHH:mm:ss"),R=async d=>{const p={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};a?S.put(`undefined/tracking_list/${a.tracking_list_id}`,d,p).then(u=>{Y(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(I,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Updated Successfully"})]}),"Tracking Details Updated.")}).catch(u=>Y(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(I,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Error!"})]}),u)):S.post("undefined/tracking_list/",d,p).then(u=>{Y(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(I,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Updated Successfully"})]}),"Tracking Details Updated.")}).catch(u=>Y(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(I,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Error!"})]}),u))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row g-4",hidden:!a,children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("span",{className:"text-muted",children:["Tracking Revision: ",a==null?void 0:a.revision]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("span",{className:"text-muted",children:["Last Updated By: ",a==null?void 0:a.created_by]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("span",{className:"text-muted",children:["Last Updated: ",f.utc(`${a==null?void 0:a.created_at}`).local().format("DD-MM-YYYY HH:mm:ss")]})})]})}),e.jsx("br",{}),e.jsxs("form",{children:[e.jsxs(C,{shadow:"none",borderSize:2,borderColor:"light",children:[e.jsx(A,{children:e.jsx(z,{children:e.jsx(P,{tag:"div",className:"h4",children:"Purchase Order"})})}),e.jsx(F,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"po_no",label:"PO No.",children:e.jsx(c,{placeholder:"Enter PO No.",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.po_no,isValid:s.isValid,isTouched:s.touched.po_no,invalidFeedback:s.errors.po_no,validFeedback:"Valid PO No."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"po_date",label:"PO Date.",children:e.jsx(c,{placeholder:"Enter PO Date",type:"date",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.po_date,isValid:s.isValid,isTouched:s.touched.po_date,invalidFeedback:s.errors.po_date,validFeedback:"Valid PO Date."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"po_amount",label:"PO Amount.",children:e.jsx(c,{type:"number",placeholder:"Enter PO Amount",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.po_amount,isValid:s.isValid,isTouched:s.touched.po_amount,invalidFeedback:s.errors.po_amount,validFeedback:"Valid PO Amount"})})}),e.jsx("div",{className:"col-md-12",children:e.jsx(G,{attachment_type:"purchase_order",attachment_list:a!=null&&a.purchase_order.po_attachments?a==null?void 0:a.purchase_order.po_attachments:[],setAttachmentIds:_})})]})}),e.jsx(D,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(C,{shadow:"none",borderSize:2,borderColor:"light",children:[e.jsx(A,{children:e.jsx(z,{children:e.jsx(P,{tag:"div",className:"h4",children:"Sales Order"})})}),e.jsx(F,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"so_no",label:"SO No.",children:e.jsx(c,{placeholder:"Enter SO No.",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.so_no,isValid:s.isValid,isTouched:s.touched.so_no,invalidFeedback:s.errors.so_no,validFeedback:"Valid SO No."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"so_date",label:"SO Date.",children:e.jsx(c,{placeholder:"Enter SO Date",type:"date",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.so_date,isValid:s.isValid,isTouched:s.touched.so_date,invalidFeedback:s.errors.so_date,validFeedback:"Valid SO Date."})})}),e.jsx("div",{className:"col-md-12",children:e.jsx(G,{attachment_type:"sale_order",attachment_list:a!=null&&a.sale_order.so_attachments?a==null?void 0:a.sale_order.so_attachments:[],setAttachmentIds:_})})]})}),e.jsx(D,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(C,{shadow:"none",borderSize:2,borderColor:"light",children:[e.jsx(A,{children:e.jsx(z,{children:e.jsx(P,{tag:"div",className:"h4",children:"Invoice"})})}),e.jsx(F,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"invoice_no",label:"Invoice No.",children:e.jsx(c,{placeholder:"Enter Invoice No.",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.invoice_no,isValid:s.isValid,isTouched:s.touched.invoice_no,invalidFeedback:s.errors.invoice_no,validFeedback:"Valid Invoice No."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"invoice_date",label:"Invoice Date.",children:e.jsx(c,{placeholder:"Enter Invoice Date",type:"date",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.invoice_date,isValid:s.isValid,isTouched:s.touched.invoice_date,invalidFeedback:s.errors.invoice_date,validFeedback:"Valid Invoice Date."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"payment_terms",label:"Payment Terms",children:e.jsx(c,{placeholder:"Enter Payment Terms",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.payment_terms,isValid:s.isValid,isTouched:s.touched.payment_terms,invalidFeedback:s.errors.payment_terms,validFeedback:"Valid Payment Terms"})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"invoice_amount",label:"Invoice Amount",children:e.jsx(c,{type:"number",placeholder:"Enter Invoice Amount",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.invoice_amount,isValid:s.isValid,isTouched:s.touched.invoice_amount,invalidFeedback:s.errors.invoice_amount,validFeedback:"Valid Invoice Amount"})})}),e.jsx("div",{className:"col-md-12",children:e.jsx(G,{attachment_type:"invoice",attachment_list:a!=null&&a.invoice.invoice_attachments?a==null?void 0:a.invoice.invoice_attachments:[],setAttachmentIds:_})})]})}),e.jsx(D,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(C,{shadow:"none",borderSize:2,borderColor:"light",children:[e.jsx(F,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"remarks",label:"Remarks",children:e.jsx(c,{placeholder:"Enter Remarks",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.remarks,isValid:s.isValid,isTouched:s.touched.remarks,invalidFeedback:s.errors.remarks,validFeedback:"Valid Remarks"})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"status_overwrite",label:"Status Overwrite",children:e.jsx(c,{placeholder:"Enter Status Overwrite",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.status_overwrite,isValid:s.isValid,isTouched:s.touched.status_overwrite,invalidFeedback:s.errors.status_overwrite,validFeedback:"Valid Status Overwrite"})})}),e.jsx("div",{className:"col-md-12"})]})}),e.jsx(D,{children:e.jsx(ce,{children:e.jsx(w,{color:"success",isLight:!0,onClick:s.submitForm,children:"Save"})})})]})]})]})},fe=n=>{var p;const a=te(),[v,b]=r.useState(Number(n.variance)),[t,l]=r.useState(n.data[0]);r.useEffect(()=>{if(n.data){const u=n.data.filter(O=>O.variance==v)[0];console.log(JSON.stringify(t)),N(H[u.status.toUpperCase()])}},[v]);const g="Tracking View",y=(p=t==null?void 0:t.status)==null?void 0:p.toUpperCase();var h=H[y];h==null&&(h=H.NONE);const[_,N]=r.useState(h),[s,k]=r.useState("Quotation"),R=u=>{a(`../quotation/edit/${t.quotation_revision_id}`,{state:{create_new_variance:u}})},d=async(u,O,L,$)=>{S.get(`undefined/quotation/${u}/pdf/${O}`,{responseType:"blob",headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{with_watermark:`${$}`}}).then(i=>{J(i.data,L+".pdf")})};return e.jsx(e.Fragment,{children:e.jsxs(re,{title:g,children:[e.jsxs(he,{children:[e.jsxs(me,{children:[e.jsx(w,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>a(-1),children:"Back"}),e.jsx(K,{}),e.jsx("strong",{className:"fs-5",children:g}),e.jsx(K,{}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("span",{children:["Quotation No: ",t.quotation_no,"    ",e.jsx(ae,{className:"statusBadge",color:_.color,children:_.name})]})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("span",{children:["Revision: ",t.revision]})})]})]}),e.jsx(ue,{children:e.jsx(w,{color:"info",onClick:()=>R(!0),children:"Create New Variation"})})]}),e.jsxs(xe,{container:"fluid",children:[e.jsxs(C,{children:[e.jsx(A,{children:e.jsx(z,{children:e.jsx(P,{tag:"div",className:"h3",children:g})})}),e.jsx(F,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"QuotationDate",label:"Quotation Date",isFloating:!0,children:e.jsx(c,{value:t.created_at,disabled:!0})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(o,{id:"client_code",label:"Client Code",isFloating:!0,children:e.jsx(c,{value:t.client_code,disabled:!0})})}),e.jsx("div",{className:"col-md-6",children:e.jsx(o,{id:"client",label:"Client",isFloating:!0,children:e.jsx(c,{value:t.client,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"end_user",label:"End User",isFloating:!0,children:e.jsx(c,{value:t.end_user,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"site_location",label:"Site Location",isFloating:!0,children:e.jsx(c,{value:t.site_location,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"building",label:"Building",isFloating:!0,children:e.jsx(c,{value:t.building,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"pic",label:"PIC",isFloating:!0,children:e.jsx(c,{value:t.pic,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(o,{id:"pic_email",label:"PIC Email",isFloating:!0,children:e.jsx(c,{value:t.pic_email,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"pic_contact_number",label:"PIC Contact No.",isFloating:!0,children:e.jsx(c,{value:t.pic_contact_number,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(o,{id:"project_ref",label:"Project Reference",isFloating:!0,children:e.jsx(c,{value:t.project_reference,disabled:!0})})})]})}),e.jsx(D,{children:e.jsx(e.Fragment,{})})]}),e.jsx(C,{children:e.jsxs(F,{children:[e.jsxs(ge,{design:"pills",children:[e.jsx(q,{isActive:s=="Quotation",children:e.jsxs(X,{isButtonGroup:!0,children:[e.jsx("div",{className:s=="Quotation"?"btn active nav-link":"btn nav-link",onClick:()=>k("Quotation"),children:v==0?"Quotation":"Variation "+v}),e.jsx(Z,{children:e.jsx(w,{className:s=="Quotation"?"btn active nav-link":"btn nav-link"})}),e.jsx(ee,{children:n.data.map(u=>e.jsx(U,{onClick:()=>{b(u.variance),k("Quotation")},children:u.variance==0?"Quotation":"Variation "+u.variance}))})]})}),e.jsx(q,{onClick:()=>k("Attachments"),isActive:s=="Attachments",children:e.jsx(w,{children:"Attachments"})}),e.jsx(q,{onClick:()=>k("Revisions"),isActive:s=="Revisions",children:e.jsx(w,{children:"Revisions"})}),e.jsx(q,{onClick:()=>k("TrackingDetails"),isActive:s=="TrackingDetails",children:e.jsx(w,{children:"Tracking Details"})})]}),e.jsx("hr",{}),e.jsx("div",{hidden:s!="Attachments",children:e.jsx(Ne,{quotation_id:n.quotation_id,variance:v})},"attachmentsTab"+v),e.jsx("div",{hidden:s!="Revisions",children:e.jsx(pe,{quotation_id:n.quotation_id,variance:v})},"revisionsTab"+v),e.jsx("div",{hidden:s!="TrackingDetails",children:e.jsx(be,{quotation_id:n.quotation_id})},"trackingDetailsTab"),e.jsxs("div",{hidden:s!="Quotation",children:[e.jsxs("div",{className:"row gt-4",children:[e.jsxs("div",{className:"col-md-6 d-flex",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-12",children:[e.jsxs("span",{children:["Quotation No: ",t.quotation_no,"   "]}),e.jsx(ae,{className:"statusBadge",color:_.color,children:_.name}),"   ",e.jsx("br",{}),e.jsxs("span",{children:["Revision: ",t.revision]})]})}),e.jsxs(X,{children:[e.jsx(Z,{hasIcon:!1,children:e.jsx(w,{color:"info",isLight:!0,icon:"Download",children:"PDF"})}),e.jsxs(ee,{children:[e.jsx(U,{children:e.jsx("span",{onClick:()=>d(n.quotation_id,t.quotation_revision_id,t.quotation_no,!1),children:"No Watermark"})}),e.jsx(U,{onClick:()=>d(n.quotation_id,t.quotation_revision_id,t.quotation_no,!0),children:"With Watermark"})]})]})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-end",children:e.jsx(w,{color:"info",className:"order-2 float-end",onClick:()=>R(!1),children:"Create Revision"})})]}),e.jsx("br",{})]})]})}),e.jsxs(C,{hidden:s!="Quotation",children:[e.jsx(A,{children:e.jsx(z,{children:e.jsx(P,{tag:"div",className:"h3",children:"Options"})})}),e.jsx(F,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"lead_time",label:"Lead Time",children:e.jsx(c,{value:t.lead_time,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"payment_terms",label:"Payment Terms",children:e.jsx(c,{value:t.payment_terms,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"validity",label:"Validity",children:e.jsx(c,{value:t.validity,disabled:!0})})}),e.jsx("div",{})]})}),e.jsx(D,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(C,{hidden:s!="Quotation",children:[e.jsx(A,{children:e.jsx(z,{children:e.jsx(P,{tag:"div",className:"h3",children:"Summary"})})}),e.jsxs(F,{className:"pb-0",children:[e.jsx(e.Fragment,{}),e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-8",children:e.jsx(o,{id:"reference_status",label:"Reference Status",isFloating:!0,children:e.jsx(c,{value:t.reference_status,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"total",label:"Total",isFloating:!0,children:e.jsx(c,{value:t.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(o,{id:"note",label:"Note",isFloating:!0,children:e.jsx(c,{value:t.note,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(o,{id:"g_total",label:"G/Total (RM)",isFloating:!0,children:e.jsx(c,{value:t.grand_total,disabled:!0})})})]})]}),e.jsx(D,{children:e.jsx(e.Fragment,{})})]})]})]})})},Fe=()=>{const{quotation_id:n,variance:a}=je(),[v,b]=r.useState(),t=async l=>{const g={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};S.get(`undefined/quotation/latest_revisions/${l}`,g).then(y=>{b(y.data.data)})};return r.useEffect(()=>{b(null),n&&t(n)},[n]),e.jsx(e.Fragment,{children:v?e.jsx(fe,{data:v,variance:a,quotation_id:n}):e.jsx(e.Fragment,{})})};export{Fe as default};
