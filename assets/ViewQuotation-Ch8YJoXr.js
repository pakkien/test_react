import{j as e,C as g,h as f,i as F,k,f as b,F as s,l as a,r as o,n as N,M as H,o as C,p as O,u as B,x as Y,P as G,S as J,b as W,B as v,d as P,e as K,a as X,t as A,N as Z,O as ee,Q as se,R as T}from"./index-kEYLbuat.js";import{B as $,Q as M}from"./enumQuotationStatus-CFQwIRpJ.js";import{A as E,a as U,f as ae,N as ie,b as y,c as le}from"./file-download-D8m7pKSl.js";import{C as V}from"./Checks-CXAbn22c.js";import{u as te,c as de,t as ne}from"./timezone-CO9ZUVlf.js";const ce=n=>e.jsx("div",{className:"pb-0",children:n.sub_items.map((i,t)=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-xl-12",children:e.jsx(E,{id:"SubItemAccordion",color:"dark",activeItemId:"SubItemAccordionItem_"+n.itemIndex,children:e.jsx(U,{id:"SubItemAccordionItem_"+n.itemIndex+"_"+t,title:`Sub Item ${n.itemIndex+1}.0`,children:e.jsxs(g,{id:"#subItem_card_id#"+t,children:[e.jsx(f,{children:e.jsx(F,{children:e.jsxs(k,{tag:"div",className:"h3",children:["Sub Item ",n.itemIndex+1,".",t," ","  "]})})}),e.jsx(b,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(a,{value:i.product_description,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(a,{value:i.brand,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"model",label:"Model",isFloating:!0,children:e.jsx(a,{value:i.model,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(a,{value:i.remarks,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3",children:e.jsx(s,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(a,{value:i.quantity,disabled:!0})})}),e.jsx("div",{className:"col-3",children:e.jsx(s,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(a,{value:i.unit,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(a,{value:i.unit_cost,disabled:!0})})}),e.jsx("div",{className:"col-2 d-flex align-items-center",children:e.jsx(s,{id:"estimated_cost",label:"Estimated Cost",children:e.jsx(V,{checked:i.estimated_cost,disabled:!0,type:"checkbox"})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(a,{value:i.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(a,{value:i.margin,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"margin_percentage",label:"Margin Percentage",isFloating:!0,children:e.jsx(a,{value:i.margin_percentage,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit_price",label:"Unit Price",isFloating:!0,children:e.jsx(a,{value:i.unit_price,disabled:!0})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_price",label:"Total Price",isFloating:!0,children:e.jsx(a,{value:i.total_price,disabled:!0})})}),e.jsx("div",{className:"col-md-12"})]})})]},i.sub_item_id)})})})}))}),re=n=>e.jsx("div",{className:"pb-0",children:n.items.map((i,t)=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-xl-12",children:e.jsx(E,{id:"ItemAccordion",color:"dark",activeItemId:"ItemAccordionItem_"+t,children:e.jsx(U,{id:"ItemAccordionItem_"+t,title:`Item ${t+1}.0`,children:e.jsxs(g,{id:"#item_card_id#"+t,children:[e.jsx(f,{children:e.jsx(F,{children:e.jsxs(k,{tag:"div",className:"h3",children:["Item ",t+1,".0   "]})})}),e.jsx(b,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(a,{value:i.product_description,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(a,{value:i.brand,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"model",label:"Model",isFloating:!0,children:e.jsx(a,{value:i.model,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(a,{value:i.remarks,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3",children:e.jsx(s,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(a,{value:i.quantity,disabled:!0})})}),e.jsx("div",{className:"col-3",children:e.jsx(s,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(a,{value:i.unit,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(a,{value:i.unit_cost,disabled:!0})})}),e.jsx("div",{className:"col-2 d-flex align-items-center",children:e.jsx(s,{id:"estimated_cost",label:"Estimated Cost",children:e.jsx(V,{checked:i.estimated_cost,disabled:!0,type:"checkbox"})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(a,{value:i.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(a,{value:i.margin,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"margin_percentage",label:"Margin Percentage",isFloating:!0,children:e.jsx(a,{value:i.margin_percentage,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit_price",label:"Unit Price",isFloating:!0,children:e.jsx(a,{value:i.unit_price,disabled:!0})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_price",label:"Total Price",isFloating:!0,children:e.jsx(a,{value:i.total_price,disabled:!0})})}),e.jsx("div",{className:"col-md-12"}),e.jsx("div",{className:"col-md-12",children:e.jsx(ce,{itemIndex:t,sub_items:i.sub_items})})]})})]},i.item_id)})})})}))}),oe=n=>{const[i,t]=o.useState([]),[j,S]=o.useState([]),r=async(d,c)=>{const x={headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{variance:`${c}`}};N.get(`undefined/quotation/revisions/${d}`,x).then(h=>{t(h.data.data)})};o.useEffect(()=>{r(n.quotation_id,n.variance),i.map(d=>l(d.quotation_revision_id))},[i.length]);const l=async d=>{const c={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};N.get(`undefined/quotation/${d}/attachments`,c).then(x=>{if(x.data.attachments){const h=Object.assign({data:i.filter(m=>m.quotation_revision_id==d)[0],attachment_list:x.data.attachments});j==null||j.push(h)}})},_=async(d,c)=>{N.get(`undefined/quotation/attachment/${d}`,{responseType:"blob",headers:{Authorization:`${localStorage.getItem("bts_token")}`}}).then(x=>{ae(x.data,c)})};return e.jsx(e.Fragment,{children:j.map(d=>e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:"/quotation/view/"+d.data.quotation_revision_id,target:"_blank",children:["Revision ",d.data.variance,".",d.data.revision]}),e.jsx("br",{}),d.attachment_list&&d.attachment_list.map(c=>e.jsxs("li",{children:[e.jsx("span",{onClick:()=>_(c.id,c.filename),children:e.jsx(H,{title:c.filename,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:c.filename})})}),e.jsx("br",{})]}))]}))})};C.extend(te);C.extend(O);C.extend(de);C.extend(ne);const xe=n=>{B();const[i,t]=o.useState([]),j=async(r,l)=>{const _={headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{variance:`${l}`}};N.get(`undefined/quotation/revisions/${r}`,_).then(d=>{t(d.data.data)})};o.useEffect(()=>{j(n.quotation_id,n.variance)},[]);const S=r=>C.utc(r).local().format("YYYY-MMM-DD HH:mm:ss");return e.jsx(e.Fragment,{children:i.map(r=>e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:"/quotation/view/"+r.quotation_revision_id,target:"_blank",children:["Revision ",r.variance,".",r.revision]})," - Created at: ",S(r.created_at),e.jsx("br",{})]}))})},be=()=>{var D;const{quotation_id:n,variance:i}=Y(),t=B(),[j,S]=o.useState([]),r=async(p,Q)=>{const w={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};N.get(`undefined/quotation/revisions/${p}`,w).then(L=>{S(L.data.data)})},[l,_]=o.useState(),d=async p=>{const Q={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};N.get(`undefined/quotation/revision/${p}`,Q).then(w=>{_(w.data)})};o.useEffect(()=>{r(n)},[]),o.useEffect(()=>{d("6791897b-a41e-4d1a-9fc5-da0de317508d")},[]);const c="Tracking View",x=(D=l==null?void 0:l.status)==null?void 0:D.toUpperCase();var h=M[x];h==null&&(h=M.NONE);const[m,ue]=o.useState(h),[u,I]=o.useState("Quotation"),[z,q]=o.useState({name:"Quotation",variance:0}),R=p=>{t(`../quotation/edit/${l.quotation_revision_id}`,{state:{create_new_variance:p}})};return e.jsx(e.Fragment,{children:l==null?e.jsx(e.Fragment,{}):e.jsxs(G,{title:c,children:[e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(v,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>t(-1),children:"Back"}),e.jsx(P,{}),e.jsx("strong",{className:"fs-5",children:c}),e.jsx(P,{}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("span",{children:["Quotation No: ",l.quotation_no,"    ",e.jsx($,{className:"statusBadge",color:m.color,children:m.name})]})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("span",{children:["Revision: ",l.variance,".",l.revision]})})]})]}),e.jsx(K,{children:e.jsx(v,{color:"info",onClick:()=>R(!0),children:"Create New Variation"})})]}),e.jsxs(X,{container:"fluid",children:[e.jsxs(g,{children:[e.jsx(f,{children:e.jsx(F,{children:e.jsx(k,{tag:"div",className:"h3",children:c})})}),e.jsx(b,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(s,{id:"QuotationDate",label:"Quotation Date",isFloating:!0,children:e.jsx(a,{value:l.created_at,disabled:!0})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(s,{id:"client_code",label:"Client Code",isFloating:!0,children:e.jsx(a,{value:l.client_code,disabled:!0})})}),e.jsx("div",{className:"col-md-6",children:e.jsx(s,{id:"client",label:"Client",isFloating:!0,children:e.jsx(a,{value:l.client,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"end_user",label:"End User",isFloating:!0,children:e.jsx(a,{value:l.end_user,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"site_location",label:"Site Location",isFloating:!0,children:e.jsx(a,{value:l.site_location,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"building",label:"Building",isFloating:!0,children:e.jsx(a,{value:l.building,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"pic",label:"PIC",isFloating:!0,children:e.jsx(a,{value:l.pic,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(s,{id:"pic_email",label:"PIC Email",isFloating:!0,children:e.jsx(a,{value:l.pic_email,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"pic_contact_number",label:"PIC Contact No.",isFloating:!0,children:e.jsx(a,{value:l.pic_contact_number,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(s,{id:"project_ref",label:"Project Reference",isFloating:!0,children:e.jsx(a,{value:l.project_reference,disabled:!0})})})]})}),e.jsx(A,{children:e.jsx(e.Fragment,{})})]}),e.jsx(g,{children:e.jsxs(b,{children:[e.jsxs(ie,{children:[e.jsx(y,{isActive:u=="Quotation",children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsx(le,{children:z.name})}),e.jsxs(se,{children:[e.jsx(T,{onClick:()=>{q({name:"Quotation",variance:0}),I("Quotation")},children:"Quotation"}),e.jsx(T,{onClick:()=>{q({name:"Variance 1",variance:1}),I("Quotation")},children:"Variation 1"})]})]})}),e.jsx(y,{onClick:()=>I("Attachments"),isActive:u=="Attachments",children:e.jsx(v,{children:"Attachments"})}),e.jsx(y,{onClick:()=>I("Revisions"),isActive:u=="Revisions",children:e.jsx(v,{children:"Revisions"})})]}),e.jsx("hr",{}),e.jsx("div",{hidden:u!="Attachments",children:e.jsx(oe,{quotation_id:l.quotation_id,variance:l.variance})}),e.jsx("div",{hidden:u!="Revisions",children:e.jsx(xe,{quotation_id:l.quotation_id,variance:l.variance})}),e.jsxs("div",{hidden:u!="Quotation",children:[e.jsxs("div",{className:"row gt-4",children:[e.jsxs("div",{className:"col-md-6 d-flex",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-12",children:[e.jsxs("span",{children:["Quotation No: ",l.quotation_no,"   "]}),e.jsx($,{className:"statusBadge",color:m.color,children:m.name}),"   ",e.jsx("br",{}),e.jsxs("span",{children:["Revision: ",l.variance,".",l.revision]})]})}),e.jsx(v,{color:"info",isLight:!0,icon:"Download",onClick:()=>t(-1),children:"PDF"})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-end",children:e.jsx(v,{color:"info",className:"order-2 float-end",onClick:()=>R(!1),children:"Create Revision"})})]}),e.jsx("br",{}),e.jsx(re,{items:l.items})]})]})}),e.jsxs(g,{hidden:u!="Quotation",children:[e.jsx(f,{children:e.jsx(F,{children:e.jsx(k,{tag:"div",className:"h3",children:"Options"})})}),e.jsx(b,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"lead_time",label:"Lead Time",children:e.jsx(a,{value:l.lead_time,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"payment_terms",label:"Payment Terms",children:e.jsx(a,{value:l.payment_terms,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"validity",label:"Validity",children:e.jsx(a,{value:l.validity,disabled:!0})})}),e.jsx("div",{})]})}),e.jsx(A,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(g,{hidden:u!="Quotation",children:[e.jsx(f,{children:e.jsx(F,{children:e.jsx(k,{tag:"div",className:"h3",children:"Summary"})})}),e.jsxs(b,{className:"pb-0",children:[e.jsx(e.Fragment,{}),e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-8",children:e.jsx(s,{id:"reference_status",label:"Reference Status",isFloating:!0,children:e.jsx(a,{value:l.reference_status,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total",label:"Total",isFloating:!0,children:e.jsx(a,{value:l.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(s,{id:"note",label:"Note",isFloating:!0,children:e.jsx(a,{value:l.note,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"g_total",label:"G/Total (RM)",isFloating:!0,children:e.jsx(a,{value:l.grand_total,disabled:!0})})})]})]}),e.jsx(A,{children:e.jsx(e.Fragment,{})})]})]})]})})};export{be as default};
