import{o as r,p as D,u as k,r as o,g as y,j as e,P as B,S as Q,b as _,B as l,d as A,a as E,A as j,C as Y,f as R,h as T,i as z,k as H,F as I,I as g,l as M,m as V,n as $}from"./index-CJ-v6s7j.js";import{B as U}from"./Badge-BGjwzHe_.js";import{P as G,u as O,d as W,a as J}from"./useSortableData-D0V56oWs.js";import{u as K,c as X,t as Z}from"./timezone-DiGorBC2.js";import"./Select-CCPm3bPX.js";r.extend(K);r.extend(D);r.extend(X);r.extend(Z);function ee(s){switch(s.toLowerCase()){case"in progress":return"danger";case"closed":return"dark";case"awarded":return"success";default:return"primary"}}const ie=()=>{const s=k(),[m,te]=o.useState(!1),[c,C]=o.useState([]),[b,i]=o.useState([]),p=async()=>{const t={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};$.get("http://127.0.0.1:5000/quotation/all_quotations_table",t).then(a=>{C(a.data.quotations),i(a.data.quotations)})};o.useEffect(()=>{p()},[]);const[d,S]=o.useState(1),[u,f]=o.useState(G[5]),{items:h,requestSort:v,getClassNamesFor:w}=O(b),x=t=>{const a=t.search.toString().toLowerCase(),F=N(a);t.search?i(F):i(c)},n=y({initialValues:{search:""},onSubmit:x,onReset:()=>i(c)}),N=t=>c.filter(a=>a.prepared_by.toLowerCase().includes(t)||a.client.toLowerCase().includes(t)||r(`${a.quotation_date}`).format("DD-MM-YYYY").includes(t)||a.quotation_no.toLowerCase().includes(t)||a.end_user.toLowerCase().includes(t)||a.revision.toString().toLowerCase().includes(t)||a.quotation_amount.toFixed(2).toString().toLowerCase().includes(t)||a.cost.toFixed(2).toString().toLowerCase().includes(t)||a.margin.toFixed(2).toString().toLowerCase().includes(t)||a.status.toLowerCase().includes(t)||a.site_location.toLowerCase().includes(t)||a.building.toLowerCase().includes(t)),L=t=>{s(`view/${t}`)},P=t=>{s(`edit/${t}`)},q=()=>{s("create")};return e.jsxs(B,{title:"Quotation",children:[e.jsx(Q,{children:e.jsxs(_,{children:[e.jsx(l,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>s(-1),children:"Back"}),e.jsx(A,{}),e.jsx("strong",{className:"fs-5",children:"Quotation"})]})}),e.jsxs(E,{container:"fluid",children:[m&&e.jsx(j,{color:"success",isLight:!0,icon:"Create",isDismissible:!0,children:"Create Success"}),e.jsxs(Y,{stretch:!0,children:[e.jsx(R,{className:"table-responsive",isScrollable:!0,children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(T,{children:e.jsx(z,{children:e.jsx(H,{tag:"div",className:"h3",children:"Quotation"})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(j,{color:"light",isLight:!0,children:e.jsx("form",{onSubmit:n.handleSubmit,children:e.jsx(I,{children:e.jsxs("div",{className:"d-flex","data-tour":"search",children:[e.jsx("label",{className:"border-0 bg-transparent",children:e.jsx(g,{icon:"Search",size:"2x",color:"primary"})}),e.jsx(M,{id:"search",placeholder:"Search...",className:"border-0 shadow-none bg-transparent",onChange:t=>{n.handleChange(t),t.target.value.length>2&&V(()=>x({...n.values,search:t.target.value}),1e3)(),t.target.value.length===0&&n.resetForm()},value:n.values.search})]})})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{color:"success",className:"float-end",icon:"Create",tag:"a",onClick:()=>q(),children:"Create"})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("table",{className:"table table-modern",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No."}),e.jsx("th",{children:"Prepared By"}),e.jsx("th",{children:"Client"}),e.jsxs("th",{onClick:()=>v("quotation_date"),className:"cursor-pointer text-decoration-underline",children:["Quotation Date",e.jsx(g,{size:"lg",className:w("quotation_date"),icon:"FilterList"})]}),e.jsx("th",{children:"Quotation No."}),e.jsx("th",{children:"End User"}),e.jsx("th",{children:"Revision"}),e.jsx("th",{children:"Quotation Amount"}),e.jsx("th",{children:"Cost"}),e.jsx("th",{children:"Margin"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Site Location"}),e.jsx("th",{children:"Building"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:W(h,d,u).map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:a+1}),e.jsx("td",{children:t.prepared_by}),e.jsx("td",{children:t.client}),e.jsx("td",{children:r.utc(`${t.quotation_date}`).local().format("DD-MM-YYYY HH:mm:ss")}),e.jsx("td",{children:t.quotation_no}),e.jsx("td",{children:t.end_user}),e.jsx("td",{children:t.revision}),e.jsx("td",{children:t.quotation_amount.toFixed(2)}),e.jsx("td",{children:t.cost.toFixed(2)}),e.jsx("td",{children:t.margin.toFixed(2)}),e.jsx("td",{children:e.jsx(U,{className:"statusBadge",color:ee(t.status),children:e.jsx("h6",{children:t.status})})}),e.jsx("td",{children:t.site_location}),e.jsx("td",{children:t.building}),e.jsx("td",{children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-auto",children:e.jsx(l,{color:"primary",icon:"RemoveRedEye",shadow:"none",hoverShadow:"lg",tag:"a",onClick:()=>L(t.quotation_rev_id)})}),e.jsx("div",{className:"col-auto",children:e.jsx(l,{color:"primary",icon:"Edit",shadow:"none",hoverShadow:"lg",tag:"a",onClick:()=>P(t.quotation_rev_id)})})]})})]},t.id))})]})})]})}),e.jsx(J,{data:h,label:"items",setCurrentPage:S,currentPage:d,perPage:u,setPerPage:f})]})]})]})};export{ie as default};
