import{z as l,D as F,r as c,M as w,o as z,p as N,j as e,P,S as y,b as D,B as p,d as B,a as T,C as A,f as M,q as Y,s as E,t as Q,A as R,F as H,I as a,v as I,w as O,x as U}from"./index-ClVttQaI.js";import{B as $,Q as _}from"./enumQuotationStatus-B_a3H9gn.js";import{P as V,u as G,d as J,a as W}from"./useSortableData-DO01Q7fC.js";import{u as K,c as X,t as Z}from"./timezone-B9lglhid.js";import{c as ee,a as se}from"./calculations-CG2cx_7e.js";import"./Select-toWh3Wih.js";l.extend(K);l.extend(F);l.extend(X);l.extend(Z);function te(i){const u=i==null?void 0:i.toUpperCase();var r=_[u];return r==null&&(r=_.NONE),r.color}const le=()=>{const{userData:i}=c.useContext(w),u=z();N({initialValues:{po_no:"",po_date:"",po_amount:"",po_attach_file:"",so_no:"",so_attach_file:"",invoice_no:"",invoice_date:"",payment_terms:"",invoice_amount:"",invoice_attach_file:"",remarks:"",status_overwrite:""},onSubmit:s=>{console.log(JSON.stringify(s))}});const[r,C]=c.useState([]),[b,x]=c.useState([]),v=async()=>{const s={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};U.get("undefined/quotation/all_quotations_table",s).then(t=>{C(t.data.quotations),x(t.data.quotations)})};c.useEffect(()=>{v()},[]);const[h,L]=c.useState(1),[j,f]=c.useState(V[5]),{items:m,requestSort:o,getClassNamesFor:n}=G(b),g=s=>{const t=s.search.toString().toLowerCase(),q=S(t);s.search?x(q):x(r)},d=N({initialValues:{search:""},onSubmit:g,onReset:()=>x(r)}),S=s=>r.filter(t=>t.prepared_by.toLowerCase().includes(s)||t.client.toLowerCase().includes(s)||l(`${t.quotation_date}`).format("DD/MM/YYYY").includes(s)||t.quotation_no.toLowerCase().includes(s)||t.end_user.toLowerCase().includes(s)||t.revision.toString().toLowerCase().includes(s)||t.quotation_amount.toFixed(2).toString().toLowerCase().includes(s)||t.cost.toFixed(2).toString().toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||t.site_location.toLowerCase().includes(s)||t.building.toLowerCase().includes(s)),k=(s,t)=>{u(`view/${s}/${t}`)};return e.jsxs(P,{title:"Tracking List",children:[e.jsx(y,{children:e.jsxs(D,{children:[e.jsx(p,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>u(-1),children:"Back"}),e.jsx(B,{}),e.jsx("strong",{className:"fs-5",children:"Tracking List"})]})}),e.jsx(T,{container:"fluid",children:e.jsxs(A,{stretch:!0,children:[e.jsx(M,{className:"table-responsive",isScrollable:!0,children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(Y,{children:e.jsx(E,{children:e.jsx(Q,{tag:"div",className:"h3",children:"Tracking List"})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(R,{color:"light",isLight:!0,children:e.jsx("form",{onSubmit:d.handleSubmit,children:e.jsx(H,{children:e.jsxs("div",{className:"d-flex","data-tour":"search",children:[e.jsx("label",{className:"border-0 bg-transparent",children:e.jsx(a,{icon:"Search",size:"2x",color:"primary"})}),e.jsx(I,{id:"search",placeholder:"Search...",className:"border-0 shadow-none bg-transparent",onChange:s=>{d.handleChange(s),s.target.value.length>2&&O(()=>g({...d.values,search:s.target.value}),1e3)(),s.target.value.length===0&&d.resetForm()},value:d.values.search})]})})})})}),e.jsx("div",{className:"col-md-4"}),e.jsx("div",{className:"col-md-12",children:e.jsxs("table",{className:"table table-modern",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No."}),e.jsxs("th",{onClick:()=>o("created_by"),className:"cursor-pointer text-decoration-underline",children:["Prepared By",e.jsx(a,{size:"lg",className:n("created_by"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("client"),className:"cursor-pointer text-decoration-underline",children:["Client",e.jsx(a,{size:"lg",className:n("client"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("quotation_date"),className:"cursor-pointer text-decoration-underline",children:["Quotation Date",e.jsx(a,{size:"lg",className:n("quotation_date"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("quotation_no"),className:"cursor-pointer text-decoration-underline",children:["Quotation No.",e.jsx(a,{size:"lg",className:n("quotation_no"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("end_user"),className:"cursor-pointer text-decoration-underline",children:["End User",e.jsx(a,{size:"lg",className:n("end_user"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("revision"),className:"cursor-pointer text-decoration-underline",children:["Revision",e.jsx(a,{size:"lg",className:n("revision"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("quotation_amount"),className:"cursor-pointer text-decoration-underline",children:["Quotation Amount",e.jsx(a,{size:"lg",className:n("quotation_amount"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("cost"),className:"cursor-pointer text-decoration-underline",children:["Cost",e.jsx(a,{size:"lg",className:n("cost"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("margin"),className:"cursor-pointer text-decoration-underline",children:["Margin",e.jsx(a,{size:"lg",className:n("margin"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("margin_percentage"),className:"cursor-pointer text-decoration-underline",children:["%",e.jsx(a,{size:"lg",className:n("margin_percentage"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("status"),className:"cursor-pointer text-decoration-underline",children:["Status",e.jsx(a,{size:"lg",className:n("status"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("site_location"),className:"cursor-pointer text-decoration-underline",children:["Site Location",e.jsx(a,{size:"lg",className:n("site_location"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>o("building"),className:"cursor-pointer text-decoration-underline",children:["Building",e.jsx(a,{size:"lg",className:n("building"),icon:"FilterList"})]}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:J(m,h,j).map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:s.prepared_by}),e.jsx("td",{children:s.client}),e.jsx("td",{children:l.utc(`${s.quotation_date}`).local().format("DD-MM-YYYY HH:mm:ss")}),e.jsx("td",{children:s.quotation_no}),e.jsx("td",{children:s.end_user}),e.jsx("td",{children:s.revision}),e.jsx("td",{children:s.quotation_amount?s.quotation_amount.toFixed(2):null}),e.jsx("td",{children:s.cost?s.cost.toFixed(2):null}),e.jsx("td",{children:s.quotation_amount&&s.cost?ee(s.cost,s.quotation_amount):null}),e.jsx("td",{children:s.quotation_amount&&s.cost?se(s.cost,s.quotation_amount):null}),e.jsx("td",{children:e.jsx($,{className:"statusBadge",color:te(s.status),children:e.jsx("h6",{children:s.status})})}),e.jsx("td",{children:s.site_location}),e.jsx("td",{children:s.building}),e.jsx("td",{children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-auto",children:e.jsx(p,{color:"primary",icon:"RemoveRedEye",shadow:"none",hoverShadow:"lg",tag:"a",hidden:!(i!=null&&i.view_quotation),onClick:()=>k(s.quotation_id,s.variance)})})})})]},s.id))})]})})]})}),e.jsx(W,{data:m,label:"items",setCurrentPage:L,currentPage:h,perPage:j,setPerPage:f})]})})]})};export{le as default};
