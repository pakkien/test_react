import{g as N,s as Y,j as e,I as P,C as k,h as C,i as V,k as F,B as _,y as ee,f as B,F as s,l as n,p as S,r as h,q as L,u as Ce,P as Ve,S as Fe,b as Be,d as Se,a as Ne,z as qe}from"./index-DL1VdbYl.js";import{A as ye,a as Me}from"./Accordion-CQ7jhzfj.js";import{d as ae,M as $,a as W,b as K,c as X}from"./Modal-zLPqzB00.js";const R=i=>{const a={};return i.product_desc?i.product_desc.length<3?a.product_desc="Must be 3 characters or more":i.product_desc.length>20&&(a.product_desc="Must be 20 characters or less"):a.product_desc="Required",i.brand?i.brand.length<3?a.brand="Must be 3 characters or more":i.brand.length>20&&(a.brand="Must be 20 characters or less"):a.brand="Required",i.model?i.model.length<3?a.model="Must be 3 characters or more":i.model.length>20&&(a.model="Must be 20 characters or less"):a.model="Required",i.remarks?i.remarks.length<3?a.remarks="Must be 3 characters or more":i.remarks.length>20&&(a.remarks="Must be 20 characters or less"):a.remarks="Required",i.unit?i.unit.length<3?a.unit="Must be 3 characters or more":i.unit.length>20&&(a.unit="Must be 20 characters or less"):a.unit="Required",i.quantity?i.quantity.length<3?a.quantity="Must be 3 characters or more":i.quantity.length>20&&(a.quantity="Must be 20 characters or less"):a.quantity="Required",i.unit_cost?i.unit_cost.length<3?a.unit_cost="Must be 3 characters or more":i.unit_cost.length>20&&(a.unit_cost="Must be 20 characters or less"):a.unit_cost="Required",i.total_cost?i.total_cost.length<3?a.total_cost="Must be 3 characters or more":i.total_cost.length>20&&(a.total_cost="Must be 20 characters or less"):a.total_cost="Required",i.margin?i.margin.length<3?a.margin="Must be 3 characters or more":i.margin.length>20&&(a.margin="Must be 20 characters or less"):a.margin="Required",i.unit_price?i.unit_price.length<3?a.unit_price="Must be 3 characters or more":i.unit_price.length>20&&(a.unit_price="Must be 20 characters or less"):a.unit_price="Required",i.total_price?i.total_price.length<3?a.total_price="Must be 3 characters or more":i.total_price.length>20&&(a.total_price="Must be 20 characters or less"):a.total_price="Required",a},Te=i=>{const a=i.mode.toLowerCase()==="view",d=N({initialValues:{product_desc:i.data.product_desc,brand:i.data.brand,model:i.data.model,remarks:i.data.remarks,quantity:i.data.quantity,unit:i.data.unit,unit_cost:i.data.unit_cost,total_cost:i.data.total_cost,margin:i.data.margin,unit_price:i.data.unit_price,total_price:i.data.total_price},validate:R,onSubmit:()=>{Y(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(P,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Updated Successfully"})]}),"The user's account details have been successfully updated.")}}),o=x=>{i.deleteSubItemfunc(x)},f=x=>{i.editSubItemfunc(x)};return e.jsxs(k,{children:[e.jsxs(C,{children:[e.jsx(V,{children:e.jsxs(F,{tag:"div",className:"h3",children:["Sub-Item Details   ",e.jsx(_,{color:"info",icon:"Edit",hidden:!!a,onClick:()=>{f(i.data)},children:"Edit"})]})}),e.jsx(ee,{children:e.jsx(_,{color:"danger",icon:"Delete",tag:"a",hidden:!!a,onClick:()=>{o(i.data)},children:"Delete Sub-Item"})})]}),e.jsx(B,{children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(n,{placeholder:"product_desc",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.product_desc,isValid:d.isValid,isTouched:d.touched.product_desc,invalidFeedback:d.errors.product_desc,validFeedback:"Valid product description",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(n,{placeholder:"brand",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.brand,isValid:d.isValid,isTouched:d.touched.brand,invalidFeedback:d.errors.brand,validFeedback:"Valid brand",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"model",label:"Model",isFloating:!0,children:e.jsx(n,{placeholder:"model",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.model,isValid:d.isValid,isTouched:d.touched.model,invalidFeedback:d.errors.model,validFeedback:"Valid model",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(n,{placeholder:"remarks",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.remarks,isValid:d.isValid,isTouched:d.touched.remarks,invalidFeedback:d.errors.remarks,validFeedback:"Valid remarks",disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(n,{placeholder:"quantity",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.quantity,isValid:d.isValid,isTouched:d.touched.quantity,invalidFeedback:d.errors.quantity,validFeedback:"Valid quantity",disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(n,{placeholder:"unit",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.unit,isValid:d.isValid,isTouched:d.touched.unit,invalidFeedback:d.errors.unit,validFeedback:"Valid unit",disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(n,{placeholder:"unit_cost",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.unit_cost,isValid:d.isValid,isTouched:d.touched.unit_cost,invalidFeedback:d.errors.unit_cost,validFeedback:"Valid unit_cost",disabled:!0})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(n,{placeholder:"unit_cost",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.total_cost,isValid:d.isValid,isTouched:d.touched.total_cost,invalidFeedback:d.errors.total_cost,validFeedback:"Valid total_cost",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(n,{placeholder:"margin",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.margin,isValid:d.isValid,isTouched:d.touched.margin,invalidFeedback:d.errors.margin,validFeedback:"Valid margin",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"unit_price",label:"Unit Price (RM)",isFloating:!0,children:e.jsx(n,{placeholder:"unit_price",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.unit_price,isValid:d.isValid,isTouched:d.touched.unit_price,invalidFeedback:d.errors.unit_price,validFeedback:"Valid unit_price",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_price",label:"Total Price (RM)",isFloating:!0,children:e.jsx(n,{placeholder:"total_price",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.total_price,isValid:d.isValid,isTouched:d.touched.total_price,invalidFeedback:d.errors.total_price,validFeedback:"Valid total_price",disabled:!0})})})]})}),e.jsx(S,{children:e.jsx(e.Fragment,{})})]})},we=i=>{const[a,d]=h.useState(i.mode.toLowerCase()),[o,f]=h.useState(i),[x,E]=h.useState(0),l=N({initialValues:{product_desc:i.data.product_desc,brand:i.data.brand,model:i.data.model,remarks:i.data.remarks,quantity:i.data.quantity,unit:i.data.unit,unit_cost:i.data.unit_cost,total_cost:i.data.total_cost,margin:i.data.margin,unit_price:i.data.unit_price,total_price:i.data.total_price},validate:R,onSubmit:m=>{}}),v=m=>{i.deleteItemfunc(m)},D=m=>{i.editItemfunc(m)},p=m=>{o.data.sub_item=o.data.sub_item.filter(M=>M.sub_item_id!=m.sub_item_id),i.deleteSubItemfunc(m),E(x+1)},q=m=>{i.editSubItemfunc(m)},A=()=>{i.addItemfunc()},y=m=>{i.addSubItemfunc(m)};return e.jsxs(k,{id:"#item_card_id#"+i.data.item_id,onSubmit:l.handleSubmit,children:[e.jsxs(C,{children:[e.jsx(V,{children:e.jsxs(F,{tag:"div",className:"h3",children:["Item Details   ",e.jsx(_,{color:"info",icon:"Edit",hidden:a=="view",onClick:()=>{D(i.data)},children:"Edit"})]})}),e.jsx(ee,{children:e.jsx(_,{color:"danger",icon:"Delete",tag:"a",hidden:a=="view",onClick:()=>{v(i.data)},children:"Delete Item"})})]}),e.jsx(B,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(n,{placeholder:"product_desc",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.product_desc,isValid:l.isValid,isTouched:l.touched.product_desc,invalidFeedback:l.errors.product_desc,validFeedback:"Valid product description",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(n,{placeholder:"brand",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.brand,isValid:l.isValid,isTouched:l.touched.brand,invalidFeedback:l.errors.brand,validFeedback:"Valid brand",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"model",label:"Model",isFloating:!0,children:e.jsx(n,{placeholder:"model",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.model,isValid:l.isValid,isTouched:l.touched.model,invalidFeedback:l.errors.model,validFeedback:"Valid model",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(n,{placeholder:"remarks",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.remarks,isValid:l.isValid,isTouched:l.touched.remarks,invalidFeedback:l.errors.remarks,validFeedback:"Valid remarks",disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(n,{placeholder:"quantity",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.quantity,isValid:l.isValid,isTouched:l.touched.quantity,invalidFeedback:l.errors.quantity,validFeedback:"Valid quantity",disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(n,{placeholder:"unit",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.unit,isValid:l.isValid,isTouched:l.touched.unit,invalidFeedback:l.errors.unit,validFeedback:"Valid unit",disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(n,{placeholder:"unit_cost",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.unit_cost,isValid:l.isValid,isTouched:l.touched.unit_cost,invalidFeedback:l.errors.unit_cost,validFeedback:"Valid unit_cost",disabled:!0})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(n,{placeholder:"unit_cost",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.total_cost,isValid:l.isValid,isTouched:l.touched.total_cost,invalidFeedback:l.errors.total_cost,validFeedback:"Valid total_cost",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(n,{placeholder:"margin",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.margin,isValid:l.isValid,isTouched:l.touched.margin,invalidFeedback:l.errors.margin,validFeedback:"Valid margin",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"unit_price",label:"Unit Price (RM)",isFloating:!0,children:e.jsx(n,{placeholder:"unit_price",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.unit_price,isValid:l.isValid,isTouched:l.touched.unit_price,invalidFeedback:l.errors.unit_price,validFeedback:"Valid unit_price",disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_price",label:"Total Price (RM)",isFloating:!0,children:e.jsx(n,{placeholder:"total_price",onChange:l.handleChange,onBlur:l.handleBlur,value:l.values.total_price,isValid:l.isValid,isTouched:l.touched.total_price,invalidFeedback:l.errors.total_price,validFeedback:"Valid total_price",disabled:!0})})}),e.jsx("div",{className:"col-md-12",children:i.data.sub_item.length>0&&e.jsx(ye,{id:"accSample",activeItemId:i.data.item_id,color:"dark",children:e.jsx(Me,{id:i.data.item_id,title:"Sub Item",children:i.data.sub_item.map(m=>e.jsx(Te,{mode:i.mode,data:m,deleteSubItemfunc:p,editSubItemfunc:q},m.sub_item_id))})})}),e.jsx("div",{className:"col-md-12"})]})}),e.jsx(S,{children:e.jsxs(L,{children:[e.jsx(_,{color:"info",icon:"Add",tag:"a",hidden:a=="view",onClick:()=>{A()},children:"Add Item"}),e.jsx(_,{color:"info",icon:"Add",tag:"a",hidden:a=="view",onClick:()=>{y(i.data.item_id)},children:"Add Sub-Item"})]})})]})},Ie=i=>{const a={};return i.client?i.client.length<3?a.client="Must be 3 characters or more":i.client.length>20&&(a.client="Must be 20 characters or less"):a.client="Required",i.end_user?i.end_user.length<3?a.end_user="Must be 3 characters or more":i.end_user.length>20&&(a.end_user="Must be 20 characters or less"):a.end_user="Required",i.site_location?i.site_location.length<3?a.site_location="Must be 3 characters or more":i.site_location.length>20&&(a.site_location="Must be 20 characters or less"):a.site_location="Required",i.building?i.building.length<3?a.building="Must be 3 characters or more":i.building.length>20&&(a.building="Must be 20 characters or less"):a.building="Required",i.pic?i.pic.length<3?a.pic="Must be 3 characters or more":i.pic.length>20&&(a.pic="Must be 20 characters or less"):a.pic="Required",i.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(i.email)||(a.email="Invalid email address"):a.email="Required",i.project_ref?i.project_ref.length<3?a.project_ref="Must be 3 characters or more":i.project_ref.length>20&&(a.project_ref="Must be 20 characters or less"):a.project_ref="Required",i.reference_status?i.reference_status.length<3?a.reference_status="Must be 3 characters or more":i.reference_status.length>20&&(a.reference_status="Must be 20 characters or less"):a.reference_status="Required",i.note?i.note.length<3?a.note="Must be 3 characters or more":i.note.length>20&&(a.note="Must be 20 characters or less"):a.note="Required",i.total?i.total.length<3?a.total="Must be 3 characters or more":i.total.length>20&&(a.total="Must be 20 characters or less"):a.total="Required",i.g_total?i.g_total.length<3?a.g_total="Must be 3 characters or more":i.g_total.length>20&&(a.g_total="Must be 20 characters or less"):a.g_total="Required",a},Re=i=>{const a=N({initialValues:{product_desc:i.data.product_desc,brand:i.data.brand,model:i.data.model,remarks:i.data.remarks,quantity:i.data.quantity,unit:i.data.unit,unit_cost:i.data.unit_cost,total_cost:i.data.total_cost,margin:i.data.margin,unit_price:i.data.unit_price,total_price:i.data.total_price},validate:R,onSubmit:d=>{let o={item_id:i.data.item_id,quotation_rev_id:i.data.quotation_rev_id,product_desc:d.product_desc,brand:d.brand,model:d.model,remarks:d.remarks,quantity:d.quantity,unit:d.unit,unit_cost:d.unit_cost,total_cost:d.total_cost,margin:d.margin,unit_price:d.unit_price,total_price:d.total_price,sub_item:i.data.sub_item};i.mode.toLowerCase()=="edit"?i.editItemfunc(o):i.mode.toLowerCase()=="create"&&i.createItemfunc(o),i.setState(!1)}});return e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(n,{placeholder:"product_desc",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.product_desc,isValid:a.isValid,isTouched:a.touched.product_desc,invalidFeedback:a.errors.product_desc,validFeedback:"Valid product description"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(n,{placeholder:"brand",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.brand,isValid:a.isValid,isTouched:a.touched.brand,invalidFeedback:a.errors.brand,validFeedback:"Valid brand"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"model",label:"Model",isFloating:!0,children:e.jsx(n,{placeholder:"model",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.model,isValid:a.isValid,isTouched:a.touched.model,invalidFeedback:a.errors.model,validFeedback:"Valid model"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(n,{placeholder:"remarks",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.remarks,isValid:a.isValid,isTouched:a.touched.remarks,invalidFeedback:a.errors.remarks,validFeedback:"Valid remarks"})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(n,{placeholder:"quantity",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.quantity,isValid:a.isValid,isTouched:a.touched.quantity,invalidFeedback:a.errors.quantity,validFeedback:"Valid quantity"})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(n,{placeholder:"unit",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.unit,isValid:a.isValid,isTouched:a.touched.unit,invalidFeedback:a.errors.unit,validFeedback:"Valid unit"})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(n,{placeholder:"unit_cost",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.unit_cost,isValid:a.isValid,isTouched:a.touched.unit_cost,invalidFeedback:a.errors.unit_cost,validFeedback:"Valid unit_cost"})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(n,{placeholder:"unit_cost",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.total_cost,isValid:a.isValid,isTouched:a.touched.total_cost,invalidFeedback:a.errors.total_cost,validFeedback:"Valid total_cost"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(n,{placeholder:"margin",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.margin,isValid:a.isValid,isTouched:a.touched.margin,invalidFeedback:a.errors.margin,validFeedback:"Valid margin"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"unit_price",label:"Unit Price (RM)",isFloating:!0,children:e.jsx(n,{placeholder:"unit_price",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.unit_price,isValid:a.isValid,isTouched:a.touched.unit_price,invalidFeedback:a.errors.unit_price,validFeedback:"Valid unit_price"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_price",label:"Total Price (RM)",isFloating:!0,children:e.jsx(n,{placeholder:"total_price",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.total_price,isValid:a.isValid,isTouched:a.touched.total_price,invalidFeedback:a.errors.total_price,validFeedback:"Valid total_price"})})}),e.jsx(ae,{children:e.jsx(_,{color:"info",icon:i.mode.toLowerCase()=="create"?"Add":"Save",onClick:a.handleSubmit,children:i.mode.toLowerCase()=="create"?"Add Item":"Save Item"})})]})},Ee=i=>{const a=N({initialValues:{product_desc:i.data.product_desc,brand:i.data.brand,model:i.data.model,remarks:i.data.remarks,quantity:i.data.quantity,unit:i.data.unit,unit_cost:i.data.unit_cost,total_cost:i.data.total_cost,margin:i.data.margin,unit_price:i.data.unit_price,total_price:i.data.total_price},validate:R,onSubmit:d=>{let o={sub_item_id:i.data.sub_item_id,item_id:i.data.item_id,product_desc:d.product_desc,brand:d.brand,model:d.model,remarks:d.remarks,quantity:d.quantity,unit:d.unit,unit_cost:d.unit_cost,total_cost:d.total_cost,margin:d.margin,unit_price:d.unit_price,total_price:d.total_price};i.mode.toLowerCase()=="edit"?i.editSubItemfunc(o):i.mode.toLowerCase()=="create"&&i.createSubItemfunc(o),i.setState(!1)}});return e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(n,{placeholder:"product_desc",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.product_desc,isValid:a.isValid,isTouched:a.touched.product_desc,invalidFeedback:a.errors.product_desc,validFeedback:"Valid product description"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(n,{placeholder:"brand",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.brand,isValid:a.isValid,isTouched:a.touched.brand,invalidFeedback:a.errors.brand,validFeedback:"Valid brand"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"model",label:"Model",isFloating:!0,children:e.jsx(n,{placeholder:"model",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.model,isValid:a.isValid,isTouched:a.touched.model,invalidFeedback:a.errors.model,validFeedback:"Valid model"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(n,{placeholder:"remarks",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.remarks,isValid:a.isValid,isTouched:a.touched.remarks,invalidFeedback:a.errors.remarks,validFeedback:"Valid remarks"})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(n,{placeholder:"quantity",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.quantity,isValid:a.isValid,isTouched:a.touched.quantity,invalidFeedback:a.errors.quantity,validFeedback:"Valid quantity"})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(n,{placeholder:"unit",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.unit,isValid:a.isValid,isTouched:a.touched.unit,invalidFeedback:a.errors.unit,validFeedback:"Valid unit"})})}),e.jsx("div",{className:"col-4",children:e.jsx(s,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(n,{placeholder:"unit_cost",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.unit_cost,isValid:a.isValid,isTouched:a.touched.unit_cost,invalidFeedback:a.errors.unit_cost,validFeedback:"Valid unit_cost"})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(n,{placeholder:"unit_cost",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.total_cost,isValid:a.isValid,isTouched:a.touched.total_cost,invalidFeedback:a.errors.total_cost,validFeedback:"Valid total_cost"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(n,{placeholder:"margin",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.margin,isValid:a.isValid,isTouched:a.touched.margin,invalidFeedback:a.errors.margin,validFeedback:"Valid margin"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"unit_price",label:"Unit Price (RM)",isFloating:!0,children:e.jsx(n,{placeholder:"unit_price",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.unit_price,isValid:a.isValid,isTouched:a.touched.unit_price,invalidFeedback:a.errors.unit_price,validFeedback:"Valid unit_price"})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total_price",label:"Total Price (RM)",isFloating:!0,children:e.jsx(n,{placeholder:"total_price",onChange:a.handleChange,onBlur:a.handleBlur,value:a.values.total_price,isValid:a.isValid,isTouched:a.touched.total_price,invalidFeedback:a.errors.total_price,validFeedback:"Valid total_price"})})}),e.jsx(ae,{children:e.jsx(_,{color:"info",icon:i.mode.toLowerCase()=="create"?"Add":"Save",onClick:a.handleSubmit,children:i.mode.toLowerCase()=="create"?"Add Sub Item":"Save Sub Item"})})]})},Oe=i=>{const a=Ce(),d=i.mode+" Quotation",o=i.mode.toLowerCase()==="view",[f,x]=h.useState(null),E=r=>{r.target.files&&x(r.target.files)},[l,v]=h.useState(!1),[D,p]=h.useState(!1),[q,A]=h.useState(!1),[y,m]=h.useState(!1),[M,ie]=h.useState(!0),[Q,de]=h.useState(null),[z,te]=h.useState(void 0),[O,le]=h.useState(!0),[De,se]=h.useState(!1),[H,ne]=h.useState(!0),T=()=>{A(!1),m(!1),ie(!0),de("xl"),te(void 0),le(!0),se(!1),ne(!0)},re={mode:"Create",data:{item_id:crypto.randomUUID(),quotation_rev_id:"",product_desc:"",brand:"",model:"",remarks:"",quantity:"0",unit:"",unit_cost:"0",total_cost:"0",margin:"0",unit_price:"0",total_price:"0",sub_item:[]}},[g,J]=h.useState(re),ce={mode:"Create",data:(r=>({sub_item_id:crypto.randomUUID(),item_id:r,product_desc:"",brand:"",model:"",remarks:"",quantity:"0",unit:"",unit_cost:"0",total_cost:"0",margin:"0",unit_price:"0",total_price:"0"}))("")},[j,G]=h.useState(ce),[c,oe]=h.useState(i),[w,I]=h.useState(0),ue=r=>{c.data.item=c.data.item.filter(u=>u.item_id!=r.item_id),I(w+1)},he=r=>{g.mode="Edit",g.data=r,J(g),v(!0),T()},me=r=>{let u=c.data.item.findIndex(b=>b.item_id==r.item_id);c.data.item[u]=r,I(w+1)},Z=()=>{g.mode="Create",g.data=be(),J(g),v(!0),T()},_e=r=>{c.data.item.push(r),oe(c),I(w+1)},be=()=>({item_id:crypto.randomUUID(),quotation_rev_id:"",product_desc:"",brand:"",model:"",remarks:"",quantity:"0",unit:"",unit_cost:"0",total_cost:"0",margin:"0",unit_price:"0",total_price:"0",sub_item:[]}),ge=r=>({sub_item_id:crypto.randomUUID(),item_id:r,product_desc:"",brand:"",model:"",remarks:"",quantity:"0",unit:"",unit_cost:"0",total_cost:"0",margin:"0",unit_price:"0",total_price:"0"}),je=r=>{let u=c.data.item.findIndex(b=>b.item_id==r.item_id);c.data.item[u].sub_item=c.data.item[u].sub_item.filter(b=>b.sub_item_id!=r.sub_item_id),I(w+1)},xe=r=>{j.mode="Edit",j.data=r,G(j),p(!0),T()},ve=r=>{j.mode="Create",j.data=ge(r),G(j),p(!0),T()},pe=r=>{let u=c.data.item.findIndex(b=>b.item_id==r.item_id);c.data.item[u].sub_item.push(r)},fe=r=>{let u=c.data.item.findIndex(U=>U.item_id==r.item_id),b=c.data.item[u].sub_item.findIndex(U=>U.sub_item_id==r.sub_item_id);c.data.item[u].sub_item[b]=r};function ke(r){return new Promise(u=>setTimeout(u,r))}const t=N({initialValues:{client:c.data.client,end_user:c.data.end_user,site_location:c.data.site_location,building:c.data.building,pic:c.data.pic,email:c.data.email,project_ref:c.data.project_ref,reference_status:c.data.reference_status,note:c.data.note,total:c.data.total,g_total:c.data.g_total,uploadfile:""},validate:Ie,onSubmit:async r=>{const u=Object.assign({quotation_id:c.data.quotation_id},r,{item:c.data.item});console.log(JSON.stringify(u)),Y(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(P,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Quotation saved"})]}),"Quotation saved successfully"),await ke(1e3),t.setSubmitting(!1)}});return e.jsxs(Ve,{title:d,children:[e.jsx(Fe,{children:e.jsxs(Be,{children:[e.jsx(_,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>a(-1),children:"Back"}),e.jsx(Se,{}),e.jsxs("strong",{className:"fs-5",children:[c.mode," Quotation"]})]})}),e.jsxs(Ne,{container:"fluid",children:[e.jsxs("form",{className:"form",id:"quotationFormId",onSubmit:t.handleSubmit,children:[e.jsxs(k,{children:[e.jsx(C,{children:e.jsx(V,{children:e.jsxs(F,{tag:"div",className:"h3",children:[c.mode," Quotation"]})})}),e.jsx(B,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"client",label:"Client",isFloating:!0,children:e.jsx(n,{placeholder:"client",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.client,isValid:t.isValid,isTouched:t.touched.client,invalidFeedback:t.errors.client,validFeedback:"Valid Client",disabled:!!o})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"end_user",label:"End User",isFloating:!0,children:e.jsx(n,{placeholder:"end_user",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.end_user,isValid:t.isValid,isTouched:t.touched.end_user,invalidFeedback:t.errors.end_user,validFeedback:"Valid End User",disabled:!!o})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"site_location",label:"Site Location",isFloating:!0,children:e.jsx(n,{placeholder:"site_location",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.site_location,isValid:t.isValid,isTouched:t.touched.site_location,invalidFeedback:t.errors.site_location,validFeedback:"Valid Site Location",disabled:!!o})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"building",label:"Building",isFloating:!0,children:e.jsx(n,{placeholder:"building",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.building,isValid:t.isValid,isTouched:t.touched.building,invalidFeedback:t.errors.building,validFeedback:"Valid Building",disabled:!!o})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"pic",label:"PIC",isFloating:!0,children:e.jsx(n,{placeholder:"pic",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.pic,isValid:t.isValid,isTouched:t.touched.pic,invalidFeedback:t.errors.pic,validFeedback:"Valid PIC",disabled:!!o})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(s,{id:"email",label:"Email",isFloating:!0,children:e.jsx(n,{placeholder:"email",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.email,isValid:t.isValid,isTouched:t.touched.email,invalidFeedback:t.errors.email,validFeedback:"Valid Email",disabled:!!o})})}),e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"project_ref",label:"Project Reference",isFloating:!0,children:e.jsx(n,{placeholder:"Project Reference",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.project_ref,isValid:t.isValid,isTouched:t.touched.project_ref,invalidFeedback:t.errors.project_ref,validFeedback:"Valid Project Reference",disabled:!!o})})})]})}),e.jsx(S,{children:e.jsx(L,{children:e.jsx(_,{color:"info",icon:"Add",tag:"a",hidden:!!o,onClick:Z,children:"Add Item"})})})]}),c.data.item.map((r,u)=>e.jsx(we,{mode:c.mode,data:r,deleteItemfunc:ue,addItemfunc:Z,editItemfunc:he,addSubItemfunc:ve,editSubItemfunc:xe,deleteSubItemfunc:je},u+crypto.randomUUID())),e.jsxs(k,{children:[e.jsx(C,{children:e.jsx(V,{children:e.jsx(F,{tag:"div",className:"h3",children:"Upload PDF"})})}),e.jsx(B,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4"}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(s,{id:"uploadfile",children:e.jsx(n,{type:"file",accept:".pdf",multiple:!0,value:t.values.uploadfile,disabled:!!o,onChange:r=>{E(r),t.handleChange(r)}})})}),e.jsx("div",{className:"col-md-12",children:f&&[...f].map((r,u)=>e.jsxs("section",{children:["File number ",u+1," details:",e.jsxs("ul",{children:[e.jsxs("li",{children:["Name: ",r.name]}),e.jsxs("li",{children:["Type: ",r.type]}),e.jsxs("li",{children:["Size: ",r.size," bytes"]})]})]},r.name))})]}),e.jsx("div",{className:"col-md-4"}),e.jsx("div",{className:"col-md-12"})]})}),e.jsx(S,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(k,{children:[e.jsx(C,{children:e.jsx(V,{children:e.jsx(F,{tag:"div",className:"h3",children:"Summary"})})}),e.jsx(B,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-8",children:e.jsx(s,{id:"reference_status",label:"Reference Status",isFloating:!0,children:e.jsx(n,{placeholder:"reference_status",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.reference_status,isValid:t.isValid,isTouched:t.touched.reference_status,invalidFeedback:t.errors.reference_status,validFeedback:"Valid reference status",disabled:!!o})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"total",label:"Total (RM)",isFloating:!0,children:e.jsx(n,{type:"number",step:2,placeholder:"total",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.total,isValid:t.isValid,isTouched:t.touched.total,invalidFeedback:t.errors.total,validFeedback:"Valid total",disabled:!!o})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(s,{id:"note",label:"Note",isFloating:!0,children:e.jsx(n,{placeholder:"note",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.note,isValid:t.isValid,isTouched:t.touched.note,invalidFeedback:t.errors.note,validFeedback:"Valid note",disabled:!!o})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(s,{id:"g_total",label:"G/Total (RM)",isFloating:!0,children:e.jsx(n,{type:"number",step:.1,placeholder:"g_total",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.g_total,isValid:t.isValid,isTouched:t.touched.g_total,invalidFeedback:t.errors.g_total,validFeedback:"Valid G/total",disabled:!!o})})})]})}),e.jsx(S,{children:e.jsxs(L,{children:[e.jsx(_,{color:"dark",icon:"Edit",hidden:!!o,children:"Draft"}),e.jsx(_,{type:"submit",color:"success",icon:t.isSubmitting?"None":"Save",isDisable:t.isSubmitting,hidden:!!o,children:t.isSubmitting?e.jsx(qe,{isSmall:!0,inButton:"onlyIcon"}):"Save"})]})})]})]}),e.jsx("form",{children:e.jsxs($,{isOpen:l,setIsOpen:v,titleId:"itemEditModal",isStaticBackdrop:q,isScrollable:y,isCentered:M,size:Q,fullScreen:z,isAnimation:O,children:[e.jsx(W,{setIsOpen:H?v:void 0,children:e.jsx(K,{id:"itemEditModalId",children:g.mode.toLowerCase()=="edit"?"Edit item":"Add item"})}),e.jsx(X,{children:e.jsx(Re,{mode:g.mode,data:g.data,editItemfunc:me,createItemfunc:_e,setState:v})})]})}),e.jsx("form",{children:e.jsxs($,{isOpen:D,setIsOpen:p,titleId:"subItemEditModal",isStaticBackdrop:q,isScrollable:y,isCentered:M,size:Q,fullScreen:z,isAnimation:O,children:[e.jsx(W,{setIsOpen:H?p:void 0,children:e.jsx(K,{id:"subItemEditModalId",children:j.mode.toLowerCase()=="edit"?"Edit Sub item":"Add Sub item"})}),e.jsx(X,{children:e.jsx(Ee,{mode:j.mode,data:j.data,editSubItemfunc:fe,createSubItemfunc:pe,setState:p})})]})})]})]})};export{Oe as S};
