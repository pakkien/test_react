import{j as e,C as p,h as C,i as y,k as S,f as _,F as l,l as t,r as h,n as A,M as q,o as R,p as ae,u as X,I as M,G as $,B as f,t as T,g as ie,v as le,P as te,S as ne,b as de,d as W,e as ce,a as re,N as oe,O as he,Q as me,R as xe,x as ue}from"./index-B1vmnCLl.js";import{A as Z,a as ee,f as Y,p as J,u as je,P as ve,N as ge,b as E}from"./Progress--tQyIR3-.js";import{C as se}from"./Checks-B9rMCtE8.js";import{Q as U,B as K}from"./enumQuotationStatus-iZ0lHAYm.js";import{u as Ne,c as be,t as pe}from"./timezone-b4PsR3zM.js";const _e=d=>e.jsx("div",{className:"pb-0",children:e.jsx("div",{className:"col-xl-12",children:e.jsx(Z,{id:"SubItemAccordion",color:"dark",activeItemId:"SubItemAccordionItem_"+d.itemIndex,children:e.jsx(ee,{id:"SubItemAccordionItem_"+d.itemIndex,title:"Sub Items",children:d.sub_items.map((i,c)=>e.jsx(e.Fragment,{children:e.jsxs(p,{id:"#subItem_card_id#"+c,children:[e.jsx(C,{children:e.jsx(y,{children:e.jsxs(S,{tag:"div",className:"h3",children:["Sub Item ",d.itemIndex+1,".",c+1," ","  "]})})}),e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(l,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(t,{value:i.product_description,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(t,{value:i.brand,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"model",label:"Model",isFloating:!0,children:e.jsx(t,{value:i.model,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(t,{value:i.remarks,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3",children:e.jsx(l,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(t,{value:i.quantity,disabled:!0})})}),e.jsx("div",{className:"col-3",children:e.jsx(l,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(t,{value:i.unit,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(l,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(t,{value:i.unit_cost,disabled:!0})})}),e.jsx("div",{className:"col-2 d-flex align-items-center",children:e.jsx(l,{id:"estimated_cost",label:"Estimated Cost",children:e.jsx(se,{checked:i.estimated_cost,disabled:!0,type:"checkbox"})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(t,{value:i.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(l,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(t,{value:i.margin,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(l,{id:"margin_percentage",label:"Margin Percentage",isFloating:!0,children:e.jsx(t,{value:i.margin_percentage,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(l,{id:"unit_price",label:"Unit Price",isFloating:!0,children:e.jsx(t,{value:i.unit_price,disabled:!0})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"total_price",label:"Total Price",isFloating:!0,children:e.jsx(t,{value:i.total_price,disabled:!0})})}),e.jsx("div",{className:"col-md-12"})]})})]},c)}))})})},d.itemIndex)}),fe=d=>e.jsx("div",{className:"pb-0",children:d.items.map((i,c)=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-xl-12",children:e.jsx(Z,{id:"ItemAccordion",color:"dark",activeItemId:"ItemAccordionItem_"+c,children:e.jsx(ee,{id:"ItemAccordionItem_"+c,title:`Item ${c+1}.0`,children:e.jsxs(p,{id:"#item_card_id#"+c,children:[e.jsx(C,{children:e.jsx(y,{children:e.jsxs(S,{tag:"div",className:"h3",children:["Item ",c+1,".0   "]})})}),e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(l,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(t,{value:i.product_description,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(t,{value:i.brand,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"model",label:"Model",isFloating:!0,children:e.jsx(t,{value:i.model,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(t,{value:i.remarks,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3",children:e.jsx(l,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(t,{value:i.quantity,disabled:!0})})}),e.jsx("div",{className:"col-3",children:e.jsx(l,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(t,{value:i.unit,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(l,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(t,{value:i.unit_cost,disabled:!0})})}),e.jsx("div",{className:"col-2 d-flex align-items-center",children:e.jsx(l,{id:"estimated_cost",label:"Estimated Cost",children:e.jsx(se,{checked:i.estimated_cost,disabled:!0,type:"checkbox"})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(t,{value:i.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(l,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(t,{value:i.margin,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(l,{id:"margin_percentage",label:"Margin Percentage",isFloating:!0,children:e.jsx(t,{value:i.margin_percentage,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(l,{id:"unit_price",label:"Unit Price",isFloating:!0,children:e.jsx(t,{value:i.unit_price,disabled:!0})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"total_price",label:"Total Price",isFloating:!0,children:e.jsx(t,{value:i.total_price,disabled:!0})})}),e.jsx("div",{className:"col-md-12"}),e.jsx("div",{className:"col-md-12",children:e.jsx(_e,{itemIndex:c,sub_items:i.sub_items})}),e.jsx("div",{className:"col-md-12"})]})})]},i.item_id)})})})}))}),ke=d=>{const[i,c]=h.useState([]),[N,n]=h.useState([]),r=async(s,m)=>{const u={headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{variance:`${m}`}};A.get(`undefined/quotation/revisions/${s}`,u).then(g=>{c(g.data.data)})};h.useEffect(()=>{r(d.quotation_id,d.variance),i.map(s=>v(s.quotation_revision_id))},[i.length]);const v=async s=>{const m={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};A.get(`undefined/quotation/${s}/attachments`,m).then(u=>{if(u.data.attachments){const g=Object.assign({data:i.filter(w=>w.quotation_revision_id==s)[0],attachment_list:u.data.attachments});N==null||N.push(g)}})},b=async(s,m)=>{A.get(`undefined/quotation/attachment/${s}`,{responseType:"blob",headers:{Authorization:`${localStorage.getItem("bts_token")}`}}).then(u=>{Y(u.data,m)})};return e.jsx(e.Fragment,{children:N.map((s,m)=>e.jsxs("div",{children:[e.jsxs("a",{href:"/quotation/view/"+s.data.quotation_revision_id,target:"_blank",children:["Revision ",s.data.revision]}),e.jsx("br",{}),s.attachment_list&&s.attachment_list.map(u=>e.jsxs("li",{children:[e.jsx("span",{onClick:()=>b(u.id,u.filename),children:e.jsx(q,{title:u.filename,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:u.filename})})}),e.jsx("br",{})]}))]},m))})};R.extend(Ne);R.extend(ae);R.extend(be);R.extend(pe);const we=d=>{X();const[i,c]=h.useState([]),N=async(r,v)=>{const b={headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{variance:`${v}`}};A.get(`undefined/quotation/revisions/${r}`,b).then(s=>{c(s.data.data)})};h.useEffect(()=>{N(d.quotation_id,d.variance)},[]);const n=r=>R.utc(r).local().format("YYYY-MMM-DD HH:mm:ss");return e.jsx(e.Fragment,{children:i.map(r=>e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:"/quotation/view/"+r.quotation_revision_id,target:"_blank",children:["Revision ",r.revision]})," - Created at: ",n(r.created_at),e.jsx("br",{})]}))})},G=10,H=d=>{const[i,c]=h.useState([]);h.useEffect(()=>{c(d.attachment_list)},[]);const N=async(a,o)=>{A.get(`undefined/quotation/attachment/${a}`,{responseType:"blob",headers:{Authorization:`${localStorage.getItem("bts_token")}`}}).then(x=>{Y(x.data,o)})},n=a=>{let o=i.filter(x=>x.id!=a);c(o)},[r,v]=h.useState([]),[b,s]=h.useState([]),[m,u]=h.useState(!1),g=async a=>{var o=new FormData;o.append("file",a);var x={onUploadProgress:function(j){const B=j.total&&j.loaded?Math.round(j.loaded*100/j.total):0;v(F=>{const I=[...F];return I.map(V=>V.name==a.name?V.upload_percent=B:null),I})},headers:{Authorization:`${localStorage.getItem("bts_token")}`}};A.post("undefined/quotation/attachment",o,x).then(function(j){const B=j.data.attachment_id;v(F=>{const I=[...F];return I.map(V=>V.name==a.name?V.upload_id=B:null),I})}).catch(function(j){v(B=>{const F=[...B];return F.map(I=>I.name==a.name?I.upload_error="Error":null),F})})},w=h.useCallback((a,o)=>{a!=null&&a.length&&(v(x=>[...x,...a.map(j=>Object.assign(j,{preview:J,upload_percent:0,upload_id:"",upload_error:""}))]),a.map(x=>g(x))),o!=null&&o.length&&s(x=>[...x,...o])},[]),{getRootProps:O,getInputProps:Q,isDragActive:z}=je({accept:{"application/*":[".pdf"]},maxSize:1024*1500,maxFiles:G-r.length,disabled:m,onDrop:w});h.useEffect(()=>()=>r.forEach(a=>URL.revokeObjectURL(a.preview)),[r]),h.useEffect(()=>{let o=r.filter(j=>j.upload_percent==100&&j.upload_id&&!j.upload_error).map(j=>j.upload_id),x=i.map(j=>j.id);d.setAttachmentIds([...o,...x],d.attachment_type)},[r,i]),h.useEffect(()=>{r.length+i.length>=G?u(!0):u(!1)},[r.length+i.length]);const k=a=>{v(o=>o.filter(x=>x.name!==a))},D=a=>{s(o=>o.filter(({file:x})=>x.name!==a))},L=()=>{v([]),s([])};function P(a,o=2){if(!+a)return"0 Bytes";const x=1024,j=o<0?0:o,B=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],F=Math.floor(Math.log(a)/Math.log(x));return`${parseFloat((a/Math.pow(x,F)).toFixed(j))} ${B[F]}`}return e.jsxs(p,{shadow:"none",borderSize:0,borderColor:"light",children:[e.jsx(C,{children:e.jsx(y,{children:e.jsxs(S,{tag:"div",className:"h5",children:["Attachments"," ",r!=null&&r.length||i!=null&&i.length?" - "+((r==null?void 0:r.length)+(i==null?void 0:i.length))+"/"+G:""]})})}),e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4 ",children:[e.jsxs("div",{hidden:m,...O({className:d.className}),children:[e.jsx("input",{...Q()}),e.jsx("div",{className:"border border-2 border-light border d-flex justify-content-center align-items-center",style:{height:150},children:e.jsxs("p",{className:"lead",children:[e.jsx(M,{icon:"Upload",size:"2x"}),z?"Drop the files here ...":"Drag & drop files here, or click to select files"]})})]}),i.map(a=>{var o;return e.jsx("div",{className:"col-xl-3 col-lg-6 col-md-12",children:e.jsx(p,{borderColor:"success",className:"shadow-none border border-2 rounded-2",children:e.jsx(_,{children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col d-flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"ratio ratio-1x1",style:{width:60},children:e.jsx("div",{className:$("d-flex align-items-center justify-content-center","overflow-hidden"),children:e.jsx("img",{src:J,alt:a.filename,width:50})})})})}),e.jsx("div",{className:"flex-grow-1 ms-3 d-flex justify-content-between",children:e.jsx("div",{className:"w-100",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"fw-bold text-truncate",style:{maxWidth:"10rem"},onClick:()=>N(a.id,a.filename),children:e.jsx(q,{title:a.filename,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:a.filename})})}),e.jsx("div",{})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:(o=a.filename.split(".").pop())==null?void 0:o.toUpperCase()})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:P(a.size)})})]})})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"float-end",children:e.jsx(f,{color:"dark",isLight:!0,icon:"Close",size:"sm",rounded:1,onClick:()=>n(a.id)})})})})]})})})})},a.id)}),r.map(a=>e.jsx("div",{className:"col-xl-3 col-lg-6 col-md-12",children:e.jsx(p,{borderColor:a.upload_error?"danger":a.upload_percent!=100?"info":"success",className:"shadow-none border border-2 rounded-2",children:e.jsx(_,{children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col d-flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"ratio ratio-1x1",style:{width:60},children:e.jsx("div",{className:$("d-flex align-items-center justify-content-center","overflow-hidden"),children:e.jsx("img",{src:a.preview,alt:a.name,width:50,onLoad:()=>{URL.revokeObjectURL(a.preview)}})})})})}),e.jsx("div",{className:"flex-grow-1 ms-3 d-flex justify-content-between",children:e.jsx("div",{className:"w-100",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"fw-bold text-truncate",style:{maxWidth:"10rem"},children:e.jsx(q,{title:a.name,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:a.name})})}),e.jsx("div",{})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:a.type})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:P(a.size)})}),e.jsx("div",{className:"col-12",children:a.upload_error?e.jsx("div",{className:"text-danger",children:a.upload_error}):a.upload_percent!=100?e.jsx(ve,{isAnimated:!0,value:a.upload_percent,max:100,color:"success",height:"0.5rem"}):e.jsxs("div",{className:"text-success",children:[e.jsx(M,{icon:"Check",size:"lg",color:"success"})," ","Uploaded"]})})]})})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"float-end",children:e.jsx(f,{color:"dark",isLight:!0,icon:"Close",size:"sm",rounded:1,onClick:()=>k(a.name)})})})})]})})})})},a.name)),b.map(({file:a,errors:o})=>e.jsx("div",{className:"col-xl-3 col-lg-6 col-md-12",children:e.jsx(p,{borderColor:"danger",className:"shadow-none border border-2 rounded-2",children:e.jsx(_,{children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col d-flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"ratio ratio-1x1",style:{width:60},children:e.jsx("div",{className:$("d-flex align-items-center justify-content-center","overflow-hidden"),children:e.jsx(M,{icon:"ErrorOutline",size:"4x",color:"danger"})})})})}),e.jsx("div",{className:"flex-grow-1 ms-3 d-flex justify-content-between",children:e.jsx("div",{className:"w-100",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"fw-bold text-truncate",style:{maxWidth:"10rem"},children:e.jsx(q,{title:a.name,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:a.name})})}),e.jsx("div",{})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:a.type})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"text-muted",children:P(a.size)})}),e.jsx("div",{className:"col-12",children:o.map(x=>e.jsx("div",{className:"text-danger",children:x.message}))})]})})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"position-relative",children:e.jsx("div",{className:"float-end",children:e.jsx(f,{color:"dark",isLight:!0,icon:"Close",size:"sm",rounded:1,onClick:()=>D(a.name)})})})})]})})})})})),e.jsx("div",{children:e.jsx(f,{color:"danger",icon:"Delete",tag:"a",hidden:!(r.length>0||b.length>0),onClick:L,isLight:!0,children:"Remove all files"})})]})}),e.jsx(T,{children:e.jsx(e.Fragment,{})})]})},Fe=d=>{const[i,c]=h.useState([]),[N,n]=h.useState([]),[r,v]=h.useState([]),b=(m,u)=>{switch(u){case"po":{c(m);break}case"so":{n(m);break}case"invoice":{v(m);break}}},s=ie({initialValues:{po_no:"",po_date:"",po_amount:0,so_no:"",invoice_no:"",invoice_date:"",payment_terms:"",invoice_amount:0,remarks:"",status_overwrite:""},enableReinitialize:!0,validate:m=>({}),onSubmit:async m=>{const u=Object.assign({po_attachment_list:i,so_attachment_list:N,invoice_attachment_list:r},m);console.log(JSON.stringify(u))}});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("span",{className:"text-muted",children:"Tracking Revision: 12"})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("span",{className:"text-muted",children:["Last Updated By: ","tester@email.com"]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("span",{className:"text-muted",children:["Last Updated: ","Sun, 08 Dec 2024 04:39:12 GMT"]})})]})}),e.jsx("br",{}),e.jsxs("form",{children:[e.jsxs(p,{shadow:"none",borderSize:2,borderColor:"light",children:[e.jsx(C,{children:e.jsx(y,{children:e.jsx(S,{tag:"div",className:"h4",children:"Purchase Order"})})}),e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"po_no",label:"PO No.",children:e.jsx(t,{placeholder:"Enter PO No.",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.po_no,isValid:s.isValid,isTouched:s.touched.po_no,invalidFeedback:s.errors.po_no,validFeedback:"Valid PO No."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"po_date",label:"PO Date.",children:e.jsx(t,{placeholder:"Enter PO Date",type:"date",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.po_date,isValid:s.isValid,isTouched:s.touched.po_date,invalidFeedback:s.errors.po_date,validFeedback:"Valid PO Date."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"po_amount",label:"PO Amount.",children:e.jsx(t,{type:"number",placeholder:"Enter PO Amount",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.po_amount,isValid:s.isValid,isTouched:s.touched.po_amount,invalidFeedback:s.errors.po_amount,validFeedback:"Valid PO Amount"})})}),e.jsx("div",{className:"col-md-12",children:e.jsx(H,{attachment_type:"po",attachment_list:[],setAttachmentIds:b})})]})}),e.jsx(T,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(p,{shadow:"none",borderSize:2,borderColor:"light",children:[e.jsx(C,{children:e.jsx(y,{children:e.jsx(S,{tag:"div",className:"h4",children:"Sales Order"})})}),e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"so_no",label:"SO No.",children:e.jsx(t,{placeholder:"Enter SO No.",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.so_no,isValid:s.isValid,isTouched:s.touched.so_no,invalidFeedback:s.errors.so_no,validFeedback:"Valid SO No."})})}),e.jsx("div",{className:"col-md-12",children:e.jsx(H,{attachment_type:"so",attachment_list:[],setAttachmentIds:b})})]})}),e.jsx(T,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(p,{shadow:"none",borderSize:2,borderColor:"light",children:[e.jsx(C,{children:e.jsx(y,{children:e.jsx(S,{tag:"div",className:"h4",children:"Invoice"})})}),e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"invoice_no",label:"Invoice No.",children:e.jsx(t,{placeholder:"Enter Invoice No.",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.invoice_no,isValid:s.isValid,isTouched:s.touched.invoice_no,invalidFeedback:s.errors.invoice_no,validFeedback:"Valid Invoice No."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"invoice_date",label:"Invoice Date.",children:e.jsx(t,{placeholder:"Enter Invoice Date",type:"date",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.invoice_date,isValid:s.isValid,isTouched:s.touched.invoice_date,invalidFeedback:s.errors.invoice_date,validFeedback:"Valid Invoice Date."})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"payment_terms",label:"Payment Terms",children:e.jsx(t,{placeholder:"Enter Payment Terms",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.payment_terms,isValid:s.isValid,isTouched:s.touched.payment_terms,invalidFeedback:s.errors.payment_terms,validFeedback:"Valid Payment Terms"})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"invoice_amount",label:"Invoice Amount",children:e.jsx(t,{type:"number",placeholder:"Enter Invoice Amount",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.invoice_amount,isValid:s.isValid,isTouched:s.touched.invoice_amount,invalidFeedback:s.errors.invoice_amount,validFeedback:"Valid Invoice Amount"})})}),e.jsx("div",{className:"col-md-12",children:e.jsx(H,{attachment_type:"invoice",attachment_list:[],setAttachmentIds:b})})]})}),e.jsx(T,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(p,{shadow:"none",borderSize:2,borderColor:"light",children:[e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"remarks",label:"Remarks",children:e.jsx(t,{placeholder:"Enter Remarks",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.remarks,isValid:s.isValid,isTouched:s.touched.remarks,invalidFeedback:s.errors.remarks,validFeedback:"Valid Remarks"})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"status_overwrite",label:"Status Overwrite",children:e.jsx(t,{placeholder:"Enter Status Overwrite",onChange:s.handleChange,onBlur:s.handleBlur,value:s.values.status_overwrite,isValid:s.isValid,isTouched:s.touched.status_overwrite,invalidFeedback:s.errors.status_overwrite,validFeedback:"Valid Status Overwrite"})})}),e.jsx("div",{className:"col-md-12"})]})}),e.jsx(T,{children:e.jsx(le,{children:e.jsx(f,{color:"success",isLight:!0,onClick:s.submitForm,children:"Save"})})})]})]})]})},Ce=d=>{var z;const i=X(),[c,N]=h.useState(Number(d.variance)),[n,r]=h.useState(d.data[0]);h.useEffect(()=>{if(d.data){const k=d.data.filter(D=>D.variance==c)[0];r(k),u(U[k.status.toUpperCase()])}},[c]);const v="Tracking View",b=(z=n==null?void 0:n.status)==null?void 0:z.toUpperCase();var s=U[b];s==null&&(s=U.NONE);const[m,u]=h.useState(s),[g,w]=h.useState("Quotation"),O=k=>{i(`../quotation/edit/${n.quotation_revision_id}`,{state:{create_new_variance:k}})},Q=async(k,D,L)=>{A.get(`undefined/quotation/${k}/pdf/${D}`,{responseType:"blob",headers:{Authorization:`${localStorage.getItem("bts_token")}`}}).then(P=>{Y(P.data,L+".pdf")})};return e.jsx(e.Fragment,{children:e.jsxs(te,{title:v,children:[e.jsxs(ne,{children:[e.jsxs(de,{children:[e.jsx(f,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>i(-1),children:"Back"}),e.jsx(W,{}),e.jsx("strong",{className:"fs-5",children:v}),e.jsx(W,{}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("span",{children:["Quotation No: ",n.quotation_no,"    ",e.jsx(K,{className:"statusBadge",color:m.color,children:m.name})]})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("span",{children:["Revision: ",n.revision]})})]})]}),e.jsx(ce,{children:e.jsx(f,{color:"info",onClick:()=>O(!0),children:"Create New Variation"})})]}),e.jsxs(re,{container:"fluid",children:[e.jsxs(p,{children:[e.jsx(C,{children:e.jsx(y,{children:e.jsx(S,{tag:"div",className:"h3",children:v})})}),e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"QuotationDate",label:"Quotation Date",isFloating:!0,children:e.jsx(t,{value:n.created_at,disabled:!0})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(l,{id:"client_code",label:"Client Code",isFloating:!0,children:e.jsx(t,{value:n.client_code,disabled:!0})})}),e.jsx("div",{className:"col-md-6",children:e.jsx(l,{id:"client",label:"Client",isFloating:!0,children:e.jsx(t,{value:n.client,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"end_user",label:"End User",isFloating:!0,children:e.jsx(t,{value:n.end_user,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"site_location",label:"Site Location",isFloating:!0,children:e.jsx(t,{value:n.site_location,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"building",label:"Building",isFloating:!0,children:e.jsx(t,{value:n.building,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"pic",label:"PIC",isFloating:!0,children:e.jsx(t,{value:n.pic,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(l,{id:"pic_email",label:"PIC Email",isFloating:!0,children:e.jsx(t,{value:n.pic_email,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"pic_contact_number",label:"PIC Contact No.",isFloating:!0,children:e.jsx(t,{value:n.pic_contact_number,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(l,{id:"project_ref",label:"Project Reference",isFloating:!0,children:e.jsx(t,{value:n.project_reference,disabled:!0})})})]})}),e.jsx(T,{children:e.jsx(e.Fragment,{})})]}),e.jsx(p,{children:e.jsxs(_,{children:[e.jsxs(ge,{design:"pills",children:[e.jsx(E,{isActive:g=="Quotation",children:e.jsxs(oe,{isButtonGroup:!0,children:[e.jsx("div",{className:g=="Quotation"?"btn active nav-link":"btn nav-link",onClick:()=>w("Quotation"),children:c==0?"Quotation":"Variation "+c}),e.jsx(he,{children:e.jsx(f,{className:g=="Quotation"?"btn active nav-link":"btn nav-link"})}),e.jsx(me,{children:d.data.map(k=>e.jsx(xe,{onClick:()=>{N(k.variance),w("Quotation")},children:k.variance==0?"Quotation":"Variation "+k.variance}))})]})}),e.jsx(E,{onClick:()=>w("Attachments"),isActive:g=="Attachments",children:e.jsx(f,{children:"Attachments"})}),e.jsx(E,{onClick:()=>w("Revisions"),isActive:g=="Revisions",children:e.jsx(f,{children:"Revisions"})}),e.jsx(E,{onClick:()=>w("TrackingDetails"),isActive:g=="TrackingDetails",children:e.jsx(f,{children:"Tracking Details"})})]}),e.jsx("hr",{}),e.jsx("div",{hidden:g!="Attachments",children:e.jsx(ke,{quotation_id:d.quotation_id,variance:c})},"attachmentsTab"+c),e.jsx("div",{hidden:g!="Revisions",children:e.jsx(we,{quotation_id:d.quotation_id,variance:c})},"revisionsTab"+c),e.jsx("div",{hidden:g!="TrackingDetails",children:e.jsx(Fe,{quotation_id:d.quotation_id})},"trackingDetailsTab"),e.jsxs("div",{hidden:g!="Quotation",children:[e.jsxs("div",{className:"row gt-4",children:[e.jsxs("div",{className:"col-md-6 d-flex",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-12",children:[e.jsxs("span",{children:["Quotation No: ",n.quotation_no," ","  "]}),e.jsx(K,{className:"statusBadge",color:m.color,children:m.name}),"   ",e.jsx("br",{}),e.jsxs("span",{children:["Revision: ",n.revision]})]})}),e.jsx(f,{color:"info",isLight:!0,icon:"Download",onClick:()=>Q(d.quotation_id,n.quotation_revision_id,n.quotation_no),children:"PDF"})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-end",children:e.jsx(f,{color:"info",className:"order-2 float-end",onClick:()=>O(!1),children:"Create Revision"})})]}),e.jsx("br",{}),e.jsx(fe,{items:n.items})]})]})}),e.jsxs(p,{hidden:g!="Quotation",children:[e.jsx(C,{children:e.jsx(y,{children:e.jsx(S,{tag:"div",className:"h3",children:"Options"})})}),e.jsx(_,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"lead_time",label:"Lead Time",children:e.jsx(t,{value:n.lead_time,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"payment_terms",label:"Payment Terms",children:e.jsx(t,{value:n.payment_terms,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"validity",label:"Validity",children:e.jsx(t,{value:n.validity,disabled:!0})})}),e.jsx("div",{})]})}),e.jsx(T,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(p,{hidden:g!="Quotation",children:[e.jsx(C,{children:e.jsx(y,{children:e.jsx(S,{tag:"div",className:"h3",children:"Summary"})})}),e.jsxs(_,{className:"pb-0",children:[e.jsx(e.Fragment,{}),e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-8",children:e.jsx(l,{id:"reference_status",label:"Reference Status",isFloating:!0,children:e.jsx(t,{value:n.reference_status,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"total",label:"Total",isFloating:!0,children:e.jsx(t,{value:n.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(l,{id:"note",label:"Note",isFloating:!0,children:e.jsx(t,{value:n.note,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(l,{id:"g_total",label:"G/Total (RM)",isFloating:!0,children:e.jsx(t,{value:n.grand_total,disabled:!0})})})]})]}),e.jsx(T,{children:e.jsx(e.Fragment,{})})]})]})]})})},Be=()=>{const{quotation_id:d,variance:i}=ue(),[c,N]=h.useState(),n=async r=>{const v={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};A.get(`undefined/quotation/latest_revisions/${r}`,v).then(b=>{N(b.data.data)})};return h.useEffect(()=>{N(null),d&&n(d)},[d]),e.jsx(e.Fragment,{children:c?e.jsx(Ce,{data:c,variance:i,quotation_id:d}):e.jsx(e.Fragment,{})})};export{Be as default};
