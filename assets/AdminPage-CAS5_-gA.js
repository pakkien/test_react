import{r as s,u as Ce,g as G,j as e,C as ie,f as le,h as re,i as ce,k as de,A as be,F as N,I as i,l as A,m as H,B as u,n as M,s as D,o as C,p as Ae,q as Le,t as ze,v as Ee,P as ye,S as Ve,b as Be,d as ve,w as Ie,a as Te}from"./index-FGr2E4ef.js";import{P as we,u as Oe,d as ke,a as Fe}from"./useSortableData-BAzBEOMN.js";import{M as ue,a as he,b as me,c as pe,d as xe}from"./Modal-BhLKOtqp.js";import{u as Pe,c as Ue,t as Ye}from"./timezone-D4BUIsib.js";import{S as Ne}from"./Select-B0kZlwJu.js";function q(o){return o?e.jsx(i,{icon:"CheckCircleOutline",className:"",color:"success",size:"2x",forceFamily:"material"}):e.jsx(i,{icon:"Cancel",className:"",color:"danger",size:"2x",forceFamily:"material"})}const Re=()=>{const[o,r]=s.useState([]),[x,c]=s.useState(o),b=async()=>{const a={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};M.get("http://127.0.0.1:5000/users",a).then(d=>{r(d.data.data),c(d.data.data)})};s.useEffect(()=>{b()},[]);function E(a){const d={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};M.delete(`http://127.0.0.1:5000/users/${a}`,d).then(k=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(i,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"User Deleted"})]}),"User deleted successfully"),b()}).catch(k=>console.log(k))}const Q=Ce(),y=a=>{Q(`manage-user/${a}`)},[L,V]=s.useState({name:"",id:-99}),[S,m]=s.useState(!1),[O,p]=s.useState(!1),[W,f]=s.useState(!1),[B,I]=s.useState(!1),[w,T]=s.useState(null),[P,J]=s.useState(void 0),[K,X]=s.useState(!0),[je,Z]=s.useState(!1),[z,ee]=s.useState(!0),te=()=>{p(!1),f(!1),I(!1),T(null),J(!1),X(!0),Z(!1),ee(!0)},[U,ae]=s.useState(1),[Y,se]=s.useState(we[5]),{items:ne,requestSort:_,getClassNamesFor:g}=Oe(x),R=a=>{const d=a.search.toString().toLowerCase(),k=oe(d);a.search?c(k):c(o)},v=G({initialValues:{search:""},onSubmit:R,onReset:()=>c(o)}),oe=a=>o.filter(d=>d.name.toLowerCase().includes(a)||d.role.toLowerCase().includes(a)||d.email.toLowerCase().includes(a));return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{stretch:!0,children:[e.jsx(le,{className:"table-responsive",isScrollable:!0,children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(re,{children:e.jsx(ce,{children:e.jsx(de,{tag:"div",className:"h3",children:"Manage Users"})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(be,{color:"light",isLight:!0,children:e.jsx("form",{onSubmit:v.handleSubmit,children:e.jsx(N,{children:e.jsxs("div",{className:"d-flex","data-tour":"search",children:[e.jsx("label",{className:"border-0 bg-transparent",children:e.jsx(i,{icon:"Search",size:"2x",color:"primary"})}),e.jsx(A,{id:"search",placeholder:"Search...",className:"border-0 shadow-none bg-transparent",onChange:a=>{v.handleChange(a),a.target.value.length>2&&H(()=>R({...v.values,search:a.target.value}),1e3)(),a.target.value.length===0&&v.resetForm()},value:v.values.search})]})})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(u,{color:"success",className:"float-end",icon:"Create",tag:"a",isDisable:!0,children:"Create"})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("table",{className:"table table-modern",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsxs("th",{onClick:()=>_("role"),className:"cursor-pointer text-decoration-underline",children:["Role",e.jsx(i,{size:"lg",className:g("role"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("name"),className:"cursor-pointer text-decoration-underline",children:["Name",e.jsx(i,{size:"lg",className:g("name"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("email"),className:"cursor-pointer text-decoration-underline",children:["Email",e.jsx(i,{size:"lg",className:g("email"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("view_quotation"),className:"cursor-pointer text-decoration-underline",children:["View Quotation",e.jsx(i,{size:"lg",className:g("view_quotation"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("write_quotation"),className:"cursor-pointer text-decoration-underline",children:["Create / Edit Quotation",e.jsx(i,{size:"lg",className:g("write_quotation"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("view_mccr"),className:"cursor-pointer text-decoration-underline",children:["View MCCR",e.jsx(i,{size:"lg",className:g("view_mccr"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>_("write_mccr"),className:"cursor-pointer text-decoration-underline",children:["Create / Edit MCCR",e.jsx(i,{size:"lg",className:g("write_mccr"),icon:"FilterList"})]}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:ke(ne,U,Y).map((a,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsx("td",{children:a.role}),e.jsx("td",{children:a.name}),e.jsx("td",{children:a.email}),e.jsx("td",{children:q(a.view_quotation)}),e.jsx("td",{children:q(a.write_quotation)}),e.jsx("td",{children:q(a.view_mccr)}),e.jsx("td",{children:q(a.write_mccr)}),e.jsx("td",{children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-auto",children:e.jsx(u,{color:"primary",icon:"Edit",shadow:"none",hoverShadow:"lg",tag:"a",target:"_blank",onClick:()=>y(a.id)})}),e.jsx("div",{className:"col-auto",children:e.jsx(u,{className:"me-4",color:"danger",isLight:!0,icon:"Delete",onClick:()=>{V({name:a.name,id:a.id}),te(),I(!0),m(!0)}})})]})})]},a.id))})]})})]})}),e.jsx(Fe,{data:ne,label:"items",setCurrentPage:ae,currentPage:U,perPage:Y,setPerPage:se})]}),e.jsxs(ue,{isOpen:S,setIsOpen:m,titleId:"exampleModalLabel",isStaticBackdrop:O,isScrollable:W,isCentered:B,size:w,fullScreen:P,isAnimation:K,children:[e.jsx(he,{setIsOpen:z?m:void 0,children:e.jsxs(me,{id:"confirmDeleteUserModal",children:["Confirm Delete User - ",L.name]})}),e.jsxs(pe,{children:["Confirm to delete ",L.name]}),e.jsxs(xe,{children:[e.jsx(u,{color:"danger",icon:"Delete",onClick:()=>{m(!1),E(L.id)},children:"Delete"}),e.jsx(u,{color:"info",isOutline:!0,className:"border-0",onClick:()=>m(!1),children:"Cancel"})]})]})]})},$e=o=>{const r=G({initialValues:{option_name:o.option_name,option_value:o.option_value},validate:x=>{const c={};return x.option_name||(c.option_name="Required"),x.option_value||(c.option_value="Required"),c},onSubmit:async x=>{await o.handleSubmit_EditOption(o.option_id,x.option_name,x.option_value)}});return e.jsx(e.Fragment,{children:e.jsxs(ue,{isOpen:o.stateEditModal,setIsOpen:o.setStateEditModal,titleId:"EditOptionModal",isStaticBackdrop:!1,isScrollable:!1,isCentered:!1,size:null,fullScreen:!1,isAnimation:!0,children:[e.jsx(he,{setIsOpen:o.setStateEditModal,children:e.jsx(me,{id:"EditOptionModalTitleId",children:"Edit Option"})}),e.jsx(pe,{children:e.jsx("div",{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(N,{id:"option_name",label:"Option Name",isFloating:!0,children:e.jsx(A,{placeholder:"Option Name",onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.option_name,isValid:r.isValid,isTouched:r.touched.option_name,invalidFeedback:r.errors.option_name,validFeedback:"Valid Option Name"})})}),e.jsx("div",{className:"col-md-6",children:e.jsx(N,{id:"option_value",label:"Option Value",isFloating:!0,children:e.jsx(A,{placeholder:"Option Value",onChange:r.handleChange,onBlur:r.handleBlur,value:r.values.option_value,isValid:r.isValid,isTouched:r.touched.option_value,invalidFeedback:r.errors.option_value,validFeedback:"Valid Option Value"})})}),e.jsx("div",{className:"col-md-12"})]})})}),e.jsxs(xe,{children:[e.jsx(u,{color:"info",isOutline:!0,className:"border-0",onClick:()=>o.setStateEditModal(!1),children:"Cancel"}),e.jsx(u,{color:"success",icon:"Save",onClick:()=>{o.setStateEditModal(!1),r.submitForm()},children:"Save"})]})]})})};C.extend(Pe);C.extend(Ae);C.extend(Ue);C.extend(Ye);const qe=()=>{const[o,r]=s.useState([]),[x,c]=s.useState(o),b=async()=>{const t={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};M.get("http://127.0.0.1:5000/option/",t).then(l=>{r(l.data.options),c(l.data.options)})};s.useEffect(()=>{b()},[]);const[E,Q]=s.useState(1),[y,L]=s.useState(we[5]),{items:V,requestSort:S,getClassNamesFor:m}=Oe(x),O=t=>{const l=t.search.toString().toLowerCase(),j=t.option_name.toString().toLowerCase(),h=W(l,j);!t.search&&!t.option_name?c(o):c(h)},p=G({initialValues:{search:"",option_name:""},onSubmit:O,onReset:()=>c(o)}),W=(t,l)=>{let j=o;return l&&(j=o.filter(h=>h.option_name.toLowerCase()===l)),j.filter(h=>h.option_name.toLowerCase().includes(t)||h.option_value.toLowerCase().includes(t)||C(`${h.created_at}`).format("DD-MM-YYYY").includes(t)||h.created_by.toLowerCase().includes(t)||C(`${h.updated_at}`).format("DD-MM-YYYY").includes(t)||h.updated_by.toLowerCase().includes(t))},[f,B]=s.useState({option_id:-99,option_name:"",option_value:""}),[I,w]=s.useState(!1),[T,P]=s.useState(!1),[J,K]=s.useState(!1),[X,je]=s.useState(!1),[Z,z]=s.useState(!1),[ee,te]=s.useState(null),[U,ae]=s.useState(void 0),[Y,se]=s.useState(!0),[ne,_]=s.useState(!1),[g,R]=s.useState(!0),v=()=>{K(!1),je(!1),z(!1),te(null),ae(!1),se(!0),_(!1),R(!0)},oe=t=>{const l={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};M.delete(`http://127.0.0.1:5000/option/${t}`,l).then(j=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(i,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Option Deleted"})]}),"Option deleted successfully"),d(!1),b()}).catch(j=>console.log(j))},[a,d]=s.useState(!1),k=async(t,l)=>{const j={headers:{Authorization:`${localStorage.getItem("bts_token")}`}},h={option_name:t,option_value:l};M.post("http://127.0.0.1:5000/option/",h,j).then($=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(i,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Option Added"})]}),"Option added successfully"),b(),n.resetForm()}).catch($=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(i,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Error"})]}),$)})},n=G({initialValues:{option_name_dropdown:"",option_name:"",option_value:""},validate:t=>{const l={};return!t.option_name&&!t.option_name_dropdown&&(l.option_name="Required"),t.option_value||(l.option_value="Required"),l},onSubmit:async t=>{const l=t.option_name_dropdown?t.option_name_dropdown:t.option_name;await k(l,t.option_value)}}),De=o.map(t=>t.option_name),_e=[...new Set(De)],ge=_e.map(t=>({value:t,text:t})),Se=_e.map(t=>({value:t,text:t}));ge.splice(0,0,{value:"",text:"Create New Option"}),Se.splice(0,0,{value:"",text:"All Option"});const Me=async(t,l,j)=>{const h={headers:{Authorization:`${localStorage.getItem("bts_token")}`}},$={option_name:l,option_value:j};M.put(`http://127.0.0.1:5000/option/${t}`,$,h).then(fe=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(i,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Option Updated"})]}),"Option updated successfully"),b()}).catch(fe=>{D(e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(i,{icon:"Info",size:"lg",className:"me-1"}),e.jsx("span",{children:"Error update option"})]}),fe)})};return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{hidden:!a,tag:"form",children:[e.jsxs(re,{children:[e.jsx(ce,{children:e.jsx(de,{tag:"div",className:"h3",children:"Add Options"})}),e.jsx(Le,{children:e.jsx(u,{color:"dark",className:"float-end",icon:"Close",tag:"a",isLight:!0,onClick:()=>{n.resetForm(),d(!1),p.resetForm()}})})]}),e.jsx(le,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:n.values.option_name_dropdown==""?"col-md-2":"col-md-4",children:e.jsx(N,{id:"option_name_dropdown",label:n.values.option_name_dropdown==""?"":"Option Name",isFloating:!0,children:e.jsx(Ne,{id:"OptionNameSelect",ariaLabel:"Default select option name",value:n.values.option_name_dropdown,list:ge,onBlur:n.handleBlur,isValid:n.isValid,isTouched:n.touched.option_name_dropdown,invalidFeedback:n.errors.option_name_dropdown,onChange:t=>{n.handleChange(t),H(()=>O({...p.values,option_name:t.target.value}),1e3)()}})})}),e.jsx("div",{className:"col-md-3",hidden:n.values.option_name_dropdown!="",children:e.jsx(N,{id:"option_name",label:"Option Name",isFloating:!0,children:e.jsx(A,{placeholder:"Option Name",onChange:n.handleChange,onBlur:n.handleBlur,value:n.values.option_name,isValid:n.isValid,isTouched:n.touched.option_name,invalidFeedback:n.errors.option_name,validFeedback:"Valid Option Name"})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(N,{id:"option_value",label:"Option Value",isFloating:!0,children:e.jsx(A,{placeholder:"Option Value",onChange:n.handleChange,onBlur:n.handleBlur,value:n.values.option_value,isValid:n.isValid,isTouched:n.touched.option_value,invalidFeedback:n.errors.option_value,validFeedback:"Valid Option Value"})})}),e.jsx("div",{className:"col-md-12"})]})}),e.jsx(ze,{children:e.jsx(Ee,{children:e.jsx(u,{color:"success",className:"float-end",icon:"Add",tag:"a",onClick:n.handleSubmit,children:"Add"})})})]}),e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",hidden:a,children:e.jsx(re,{children:e.jsx(ce,{children:e.jsx(de,{tag:"div",className:"h3",children:"Manage Options"})})})}),e.jsx("div",{className:"col-md-2",hidden:a,children:e.jsx(N,{id:"option_name_dropdown",label:n.values.option_name_dropdown==""?"":"Option Name",isFloating:!0,children:e.jsx(Ne,{id:"OptionNameSelect",ariaLabel:"Default select option name",value:n.values.option_name_dropdown,list:Se,isTouched:n.touched.option_name_dropdown,onChange:t=>{n.handleChange(t),H(()=>O({...p.values,option_name:t.target.value,search:p.values.search}),1e3)()}})})}),e.jsx("div",{className:"col-md-4",hidden:a,children:e.jsx(be,{color:"light",isLight:!0,children:e.jsx("form",{onSubmit:p.handleSubmit,children:e.jsx(N,{children:e.jsxs("div",{className:"d-flex","data-tour":"search",children:[e.jsx("label",{className:"border-0 bg-transparent",children:e.jsx(i,{icon:"Search",size:"2x",color:"primary"})}),e.jsx(A,{id:"search",placeholder:"Search...",className:"border-0 shadow-none bg-transparent",onChange:t=>{p.handleChange(t),t.target.value.length>2&&H(()=>O({...p.values,search:t.target.value,option_name:n.values.option_name_dropdown}),1e3)(),t.target.value.length===0&&p.resetForm()},value:p.values.search})]})})})})}),e.jsx("div",{className:"col-md-3",hidden:a,children:e.jsx(u,{color:"primary",className:"float-end",icon:"Add",tag:"a",onClick:()=>{d(!0),p.resetForm(),n.resetForm()},children:"Add"})}),e.jsx("div",{className:"col-md-12"}),e.jsx("div",{className:"col-md-12",children:e.jsxs("table",{className:"table table-modern",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsxs("th",{onClick:()=>S("option_name"),className:"cursor-pointer text-decoration-underline",children:["Option Name",e.jsx(i,{size:"lg",className:m("option_name"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("option_value"),className:"cursor-pointer text-decoration-underline",children:["Option Value",e.jsx(i,{size:"lg",className:m("option_value"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("created_at"),className:"cursor-pointer text-decoration-underline",children:["Created Datetime",e.jsx(i,{size:"lg",className:m("created_at"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("created_by"),className:"cursor-pointer text-decoration-underline",children:["Created By",e.jsx(i,{size:"lg",className:m("created_by"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("updated_at"),className:"cursor-pointer text-decoration-underline",children:["Updated Datetime",e.jsx(i,{size:"lg",className:m("updated_at"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>S("updated_by"),className:"cursor-pointer text-decoration-underline",children:["Updated By",e.jsx(i,{size:"lg",className:m("updated_by"),icon:"FilterList"})]}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:ke(V,E,y).map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:t.option_name}),e.jsx("td",{children:t.option_value}),e.jsx("td",{children:C.utc(`${t.created_at}`).local().format("DD-MM-YYYY HH:mm:ss")}),e.jsx("td",{children:t.created_by}),e.jsx("td",{children:C.utc(`${t.updated_at}`).local().format("DD-MM-YYYY HH:mm:ss")}),e.jsx("td",{children:t.updated_by}),e.jsxs("td",{children:[e.jsx(u,{className:"me-4",color:"primary",isLight:!0,icon:"Edit",onClick:()=>{B({option_id:t.option_id,option_name:t.option_name,option_value:t.option_value}),v(),z(!0),P(!0)}}),e.jsx(u,{className:"me-4",color:"danger",isLight:!0,icon:"Delete",onClick:()=>{B({option_id:t.option_id,option_name:t.option_name,option_value:t.option_value}),v(),z(!0),w(!0)}})]})]},t.option_id))})]})})]})}),e.jsx(Fe,{data:V,label:"items",setCurrentPage:Q,currentPage:E,perPage:y,setPerPage:L})]}),e.jsxs(ue,{isOpen:I,setIsOpen:w,titleId:"exampleModalLabel",isStaticBackdrop:J,isScrollable:X,isCentered:Z,size:ee,fullScreen:U,isAnimation:Y,children:[e.jsx(he,{setIsOpen:g?w:void 0,children:e.jsx(me,{id:"confirmDeleteUserModal",children:"Confirm Delete:"})}),e.jsx(pe,{children:e.jsxs("p",{children:["Option Name: ",f.option_name," ",e.jsx("br",{})," Option Value:"," ",f.option_value]})}),e.jsxs(xe,{children:[e.jsx(u,{color:"danger",icon:"Delete",onClick:()=>{w(!1),oe(f.option_id)},children:"Delete"}),e.jsx(u,{color:"info",isOutline:!0,className:"border-0",onClick:()=>w(!1),children:"Cancel"})]})]}),T&&e.jsx($e,{option_id:f.option_id,option_name:f.option_name,option_value:f.option_value,stateEditModal:T,setStateEditModal:P,handleSubmit_EditOption:Me})]})},F={MANAGE_USERS:"Manage Users",MANAGE_OPTIONS:"Manage Options"},Ke=()=>{const[o,r]=s.useState(F.MANAGE_USERS),x=Ce();return e.jsxs(ye,{title:"Admin",children:[e.jsx(Ve,{children:e.jsxs(Be,{children:[e.jsx(u,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>x(-1),children:"Back"}),e.jsx(ve,{}),e.jsx("strong",{className:"fs-5",children:"Admin"}),e.jsx(ve,{}),e.jsx(Ie,{children:Object.keys(F).map(c=>e.jsx(u,{color:o===F[c]?"success":"light",onClick:()=>r(F[c]),children:F[c]},c))})]})}),e.jsx(Te,{container:"fluid",children:o==F.MANAGE_USERS?e.jsx(Re,{}):e.jsx(qe,{})})]})};export{Ke as default};
