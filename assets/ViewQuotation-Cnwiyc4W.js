import{j as e,C as b,h as f,i as p,k as F,f as N,F as a,l as i,r as x,n as k,M,o as C,p as B,u as R,P as E,S as V,b as U,B as g,d as A,e as L,a as z,t as S,N as O,O as H,Q as Y,R as J,x as G}from"./index-ls-PhYOF.js";import{A as P,a as Q,f as W,N as K,b as w,c as X}from"./file-download-B-8dZpXm.js";import{C as q}from"./Checks-FMKacph3.js";import{B as T,Q as D}from"./enumQuotationStatus-C2Ji7f6o.js";import{u as Z,c as ee,t as se}from"./timezone-BnRlido8.js";const ae=t=>e.jsx("div",{className:"pb-0",children:t.sub_items.map((s,d)=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-xl-12",children:e.jsx(P,{id:"SubItemAccordion",color:"dark",activeItemId:"SubItemAccordionItem_"+t.itemIndex,children:e.jsx(Q,{id:"SubItemAccordionItem_"+t.itemIndex+"_"+d,title:`Sub Item ${t.itemIndex+1}.0`,children:e.jsxs(b,{id:"#subItem_card_id#"+d,children:[e.jsx(f,{children:e.jsx(p,{children:e.jsxs(F,{tag:"div",className:"h3",children:["Sub Item ",t.itemIndex+1,".",d," ","  "]})})}),e.jsx(N,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(a,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(i,{value:s.product_description,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(i,{value:s.brand,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"model",label:"Model",isFloating:!0,children:e.jsx(i,{value:s.model,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(i,{value:s.remarks,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3",children:e.jsx(a,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(i,{value:s.quantity,disabled:!0})})}),e.jsx("div",{className:"col-3",children:e.jsx(a,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(i,{value:s.unit,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(a,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(i,{value:s.unit_cost,disabled:!0})})}),e.jsx("div",{className:"col-2 d-flex align-items-center",children:e.jsx(a,{id:"estimated_cost",label:"Estimated Cost",children:e.jsx(q,{checked:s.estimated_cost,disabled:!0,type:"checkbox"})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(i,{value:s.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(a,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(i,{value:s.margin,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(a,{id:"margin_percentage",label:"Margin Percentage",isFloating:!0,children:e.jsx(i,{value:s.margin_percentage,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(a,{id:"unit_price",label:"Unit Price",isFloating:!0,children:e.jsx(i,{value:s.unit_price,disabled:!0})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"total_price",label:"Total Price",isFloating:!0,children:e.jsx(i,{value:s.total_price,disabled:!0})})}),e.jsx("div",{className:"col-md-12"})]})})]},s.sub_item_id)})})},s.sub_item_id)}))}),ie=t=>e.jsx("div",{className:"pb-0",children:t.items.map((s,d)=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-xl-12",children:e.jsx(P,{id:"ItemAccordion",color:"dark",activeItemId:"ItemAccordionItem_"+d,children:e.jsx(Q,{id:"ItemAccordionItem_"+d,title:`Item ${d+1}.0`,children:e.jsxs(b,{id:"#item_card_id#"+d,children:[e.jsx(f,{children:e.jsx(p,{children:e.jsxs(F,{tag:"div",className:"h3",children:["Item ",d+1,".0   "]})})}),e.jsx(N,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(a,{id:"product_desc",label:"Product Description | Job Scope",isFloating:!0,children:e.jsx(i,{value:s.product_description,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"brand",label:"Brand",isFloating:!0,children:e.jsx(i,{value:s.brand,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"model",label:"Model",isFloating:!0,children:e.jsx(i,{value:s.model,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"remarks",label:"Remarks",isFloating:!0,children:e.jsx(i,{value:s.remarks,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3",children:e.jsx(a,{id:"quantity",label:"Quantity",isFloating:!0,children:e.jsx(i,{value:s.quantity,disabled:!0})})}),e.jsx("div",{className:"col-3",children:e.jsx(a,{id:"unit",label:"Unit",isFloating:!0,children:e.jsx(i,{value:s.unit,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(a,{id:"unit_cost",label:"Unit Cost",isFloating:!0,children:e.jsx(i,{value:s.unit_cost,disabled:!0})})}),e.jsx("div",{className:"col-2 d-flex align-items-center",children:e.jsx(a,{id:"estimated_cost",label:"Estimated Cost",children:e.jsx(q,{checked:s.estimated_cost,disabled:!0,type:"checkbox"})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"total_cost",label:"Total Cost",isFloating:!0,children:e.jsx(i,{value:s.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx(a,{id:"margin",label:"Margin",isFloating:!0,children:e.jsx(i,{value:s.margin,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(a,{id:"margin_percentage",label:"Margin Percentage",isFloating:!0,children:e.jsx(i,{value:s.margin_percentage,disabled:!0})})}),e.jsx("div",{className:"col-4",children:e.jsx(a,{id:"unit_price",label:"Unit Price",isFloating:!0,children:e.jsx(i,{value:s.unit_price,disabled:!0})})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"total_price",label:"Total Price",isFloating:!0,children:e.jsx(i,{value:s.total_price,disabled:!0})})}),e.jsx("div",{className:"col-md-12"}),e.jsx("div",{className:"col-md-12",children:e.jsx(ae,{itemIndex:d,sub_items:s.sub_items})}),e.jsx("div",{className:"col-md-12"})]})})]},s.item_id)})})})}))}),le=t=>{const[s,d]=x.useState([]),[u,l]=x.useState([]),r=async(n,c)=>{const v={headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{variance:`${c}`}};k.get(`undefined/quotation/revisions/${n}`,v).then(o=>{d(o.data.data)})};x.useEffect(()=>{r(t.quotation_id,t.variance),s.map(n=>j(n.quotation_revision_id))},[s.length]);const j=async n=>{const c={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};k.get(`undefined/quotation/${n}/attachments`,c).then(v=>{if(v.data.attachments){const o=Object.assign({data:s.filter(_=>_.quotation_revision_id==n)[0],attachment_list:v.data.attachments});u==null||u.push(o)}})},m=async(n,c)=>{k.get(`undefined/quotation/attachment/${n}`,{responseType:"blob",headers:{Authorization:`${localStorage.getItem("bts_token")}`}}).then(v=>{W(v.data,c)})};return e.jsx(e.Fragment,{children:u.map(n=>e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:"/quotation/view/"+n.data.quotation_revision_id,target:"_blank",children:["Revision ",n.data.revision]}),e.jsx("br",{}),n.attachment_list&&n.attachment_list.map(c=>e.jsxs("li",{children:[e.jsx("span",{onClick:()=>m(c.id,c.filename),children:e.jsx(M,{title:c.filename,flip:["auto"],children:e.jsx("a",{style:{cursor:"pointer"},children:c.filename})})}),e.jsx("br",{})]}))]}))})};C.extend(Z);C.extend(B);C.extend(ee);C.extend(se);const te=t=>{R();const[s,d]=x.useState([]),u=async(r,j)=>{const m={headers:{Authorization:`${localStorage.getItem("bts_token")}`},params:{variance:`${j}`}};k.get(`undefined/quotation/revisions/${r}`,m).then(n=>{d(n.data.data)})};x.useEffect(()=>{u(t.quotation_id,t.variance)},[]);const l=r=>C.utc(r).local().format("YYYY-MMM-DD HH:mm:ss");return e.jsx(e.Fragment,{children:s.map(r=>e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:"/quotation/view/"+r.quotation_revision_id,target:"_blank",children:["Revision ",r.revision]})," - Created at: ",l(r.created_at),e.jsx("br",{})]}))})},de=t=>{var y;const s=R(),[d,u]=x.useState(Number(t.variance)),[l,r]=x.useState(t.data[0]);x.useEffect(()=>{if(t.data){const h=t.data.filter($=>$.variance==d)[0];r(h),console.log("curr"+JSON.stringify(h))}},[d]);const j="Tracking View",m=(y=l==null?void 0:l.status)==null?void 0:y.toUpperCase();var n=D[m];n==null&&(n=D.NONE);const[c,v]=x.useState(n),[o,_]=x.useState("Quotation"),I=h=>{s(`../quotation/edit/${l.quotation_revision_id}`,{state:{create_new_variance:h}})};return e.jsx(e.Fragment,{children:e.jsxs(E,{title:j,children:[e.jsxs(V,{children:[e.jsxs(U,{children:[e.jsx(g,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>s(-1),children:"Back"}),e.jsx(A,{}),e.jsx("strong",{className:"fs-5",children:j}),e.jsx(A,{}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("span",{children:["Quotation No: ",l.quotation_no,"    ",e.jsx(T,{className:"statusBadge",color:c.color,children:c.name})]})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("span",{children:["Revision: ",l.revision]})})]})]}),e.jsx(L,{children:e.jsx(g,{color:"info",onClick:()=>I(!0),children:"Create New Variation"})})]}),e.jsxs(z,{container:"fluid",children:[e.jsxs(b,{children:[e.jsx(f,{children:e.jsx(p,{children:e.jsx(F,{tag:"div",className:"h3",children:j})})}),e.jsx(N,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(a,{id:"QuotationDate",label:"Quotation Date",isFloating:!0,children:e.jsx(i,{value:l.created_at,disabled:!0})})}),e.jsx("div",{className:"col-md-3",children:e.jsx(a,{id:"client_code",label:"Client Code",isFloating:!0,children:e.jsx(i,{value:l.client_code,disabled:!0})})}),e.jsx("div",{className:"col-md-6",children:e.jsx(a,{id:"client",label:"Client",isFloating:!0,children:e.jsx(i,{value:l.client,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"end_user",label:"End User",isFloating:!0,children:e.jsx(i,{value:l.end_user,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"site_location",label:"Site Location",isFloating:!0,children:e.jsx(i,{value:l.site_location,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"building",label:"Building",isFloating:!0,children:e.jsx(i,{value:l.building,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"pic",label:"PIC",isFloating:!0,children:e.jsx(i,{value:l.pic,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(a,{id:"pic_email",label:"PIC Email",isFloating:!0,children:e.jsx(i,{value:l.pic_email,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"pic_contact_number",label:"PIC Contact No.",isFloating:!0,children:e.jsx(i,{value:l.pic_contact_number,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(a,{id:"project_ref",label:"Project Reference",isFloating:!0,children:e.jsx(i,{value:l.project_reference,disabled:!0})})})]})}),e.jsx(S,{children:e.jsx(e.Fragment,{})})]}),e.jsx(b,{children:e.jsxs(N,{children:[e.jsxs(K,{design:"pills",children:[e.jsx(w,{isActive:o=="Quotation",children:e.jsxs(O,{children:[e.jsx(H,{children:e.jsx(X,{children:d==0?"Quotation":"Variation "+d})}),e.jsx(Y,{children:t.data.map(h=>e.jsx(J,{onClick:()=>{u(h.variance),_("Quotation")},children:h.variance==0?"Quotation":"Variation "+h.variance}))})]})}),e.jsx(w,{onClick:()=>_("Attachments"),isActive:o=="Attachments",children:e.jsx(g,{children:"Attachments"})}),e.jsx(w,{onClick:()=>_("Revisions"),isActive:o=="Revisions",children:e.jsx(g,{children:"Revisions"})})]}),e.jsx("hr",{}),e.jsx("div",{hidden:o!="Attachments",children:e.jsx(le,{quotation_id:t.quotation_id,variance:d})},"attachmentsTab"+d),e.jsx("div",{hidden:o!="Revisions",children:e.jsx(te,{quotation_id:t.quotation_id,variance:d})},"revisionsTab"+d),e.jsxs("div",{hidden:o!="Quotation",children:[e.jsxs("div",{className:"row gt-4",children:[e.jsxs("div",{className:"col-md-6 d-flex",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-12",children:[e.jsxs("span",{children:["Quotation No: ",l.quotation_no," ","  "]}),e.jsx(T,{className:"statusBadge",color:c.color,children:c.name}),"   ",e.jsx("br",{}),e.jsxs("span",{children:["Revision: ",l.revision]})]})}),e.jsx(g,{color:"info",isLight:!0,icon:"Download",onClick:()=>s(-1),children:"PDF"})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-end",children:e.jsx(g,{color:"info",className:"order-2 float-end",onClick:()=>I(!1),children:"Create Revision"})})]}),e.jsx("br",{}),e.jsx(ie,{items:l.items})]})]})}),e.jsxs(b,{hidden:o!="Quotation",children:[e.jsx(f,{children:e.jsx(p,{children:e.jsx(F,{tag:"div",className:"h3",children:"Options"})})}),e.jsx(N,{className:"pb-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"lead_time",label:"Lead Time",children:e.jsx(i,{value:l.lead_time,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"payment_terms",label:"Payment Terms",children:e.jsx(i,{value:l.payment_terms,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"validity",label:"Validity",children:e.jsx(i,{value:l.validity,disabled:!0})})}),e.jsx("div",{})]})}),e.jsx(S,{children:e.jsx(e.Fragment,{})})]}),e.jsxs(b,{hidden:o!="Quotation",children:[e.jsx(f,{children:e.jsx(p,{children:e.jsx(F,{tag:"div",className:"h3",children:"Summary"})})}),e.jsxs(N,{className:"pb-0",children:[e.jsx(e.Fragment,{}),e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-8",children:e.jsx(a,{id:"reference_status",label:"Reference Status",isFloating:!0,children:e.jsx(i,{value:l.reference_status,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"total",label:"Total",isFloating:!0,children:e.jsx(i,{value:l.total_cost,disabled:!0})})}),e.jsx("div",{className:"col-md-8",children:e.jsx(a,{id:"note",label:"Note",isFloating:!0,children:e.jsx(i,{value:l.note,disabled:!0})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(a,{id:"g_total",label:"G/Total (RM)",isFloating:!0,children:e.jsx(i,{value:l.grand_total,disabled:!0})})})]})]}),e.jsx(S,{children:e.jsx(e.Fragment,{})})]})]})]})})},ue=()=>{const{quotation_id:t,variance:s}=G(),[d,u]=x.useState(),l=async r=>{const j={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};k.get(`undefined/quotation/latest_revisions/${r}`,j).then(m=>{u(m.data.data)})};return x.useEffect(()=>{u(null),t&&l(t)},[t]),e.jsx(e.Fragment,{children:d?e.jsx(de,{data:d,variance:s,quotation_id:t}):e.jsx(e.Fragment,{})})};export{ue as default};
