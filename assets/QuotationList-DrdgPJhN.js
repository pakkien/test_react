import{z as c,D as P,o as y,r as l,M as Q,p as A,j as e,P as B,S as D,b as T,B as h,d as E,a as M,A as p,C as Y,f as R,q as I,s as H,t as U,F as V,I as o,v as $,w as O,x as G}from"./index-ClVttQaI.js";import{B as W,Q as b}from"./enumQuotationStatus-B_a3H9gn.js";import{P as J,u as K,d as X,a as Z}from"./useSortableData-DO01Q7fC.js";import{c as ee,a as se}from"./calculations-CG2cx_7e.js";import{u as te,c as oe,t as ae}from"./timezone-B9lglhid.js";import"./Select-toWh3Wih.js";c.extend(te);c.extend(P);c.extend(oe);c.extend(ae);function ne(r){const i=r==null?void 0:r.toUpperCase();var d=b[i];return d==null&&(d=b.NONE),d.color}const he=()=>{const r=y(),{userData:i}=l.useContext(Q),[d,ie]=l.useState(!1),[j,_]=l.useState([]),[v,x]=l.useState([]),L=async()=>{const s={headers:{Authorization:`${localStorage.getItem("bts_token")}`}};G.get("undefined/quotation/all_quotations_table",s).then(t=>{_(t.data.quotations),x(t.data.quotations)})};l.useEffect(()=>{L()},[]);const[m,S]=l.useState(1),[g,f]=l.useState(J[5]),{items:N,requestSort:a,getClassNamesFor:n}=K(v),C=s=>{const t=s.search.toString().toLowerCase(),z=q(t);s.search?x(z):x(j)},u=A({initialValues:{search:""},onSubmit:C,onReset:()=>x(j)}),q=s=>j.filter(t=>t.prepared_by.toLowerCase().includes(s)||t.client.toLowerCase().includes(s)||c(`${t.quotation_date}`).format("DD-MM-YYYY").includes(s)||t.quotation_no.toLowerCase().includes(s)||t.end_user.toLowerCase().includes(s)||t.revision.toString().toLowerCase().includes(s)||t.quotation_amount.toFixed(2).toString().toLowerCase().includes(s)||t.cost.toFixed(2).toString().toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||t.site_location.toLowerCase().includes(s)||t.building.toLowerCase().includes(s)),w=s=>{r(`view/${s}`)},F=s=>{r(`edit/${s}`)},k=()=>{r("create")};return e.jsxs(B,{title:"Quotation",children:[e.jsx(D,{children:e.jsxs(T,{children:[e.jsx(h,{color:"info",isLink:!0,icon:"ArrowBack",onClick:()=>r(-1),children:"Back"}),e.jsx(E,{}),e.jsx("strong",{className:"fs-5",children:"Quotation"})]})}),e.jsxs(M,{container:"fluid",children:[d&&e.jsx(p,{color:"success",isLight:!0,icon:"Create",isDismissible:!0,children:"Create Success"}),e.jsxs(Y,{stretch:!0,children:[e.jsx(R,{className:"table-responsive",isScrollable:!0,children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(I,{children:e.jsx(H,{children:e.jsx(U,{tag:"div",className:"h3",children:"Quotation"})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(p,{color:"light",isLight:!0,children:e.jsx("form",{onSubmit:u.handleSubmit,children:e.jsx(V,{children:e.jsxs("div",{className:"d-flex","data-tour":"search",children:[e.jsx("label",{className:"border-0 bg-transparent",children:e.jsx(o,{icon:"Search",size:"2x",color:"primary"})}),e.jsx($,{id:"search",placeholder:"Search...",className:"border-0 shadow-none bg-transparent",onChange:s=>{u.handleChange(s),s.target.value.length>2&&O(()=>C({...u.values,search:s.target.value}),1e3)(),s.target.value.length===0&&u.resetForm()},value:u.values.search})]})})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{color:"success",className:"float-end",icon:"Create",tag:"a",hidden:!(i!=null&&i.write_quotation),onClick:()=>k(),children:"Create"})}),e.jsx("div",{className:"col-md-12",children:e.jsxs("table",{className:"table table-modern",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No."}),e.jsxs("th",{onClick:()=>a("created_by"),className:"cursor-pointer text-decoration-underline",children:["Prepared By",e.jsx(o,{size:"lg",className:n("created_by"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("client"),className:"cursor-pointer text-decoration-underline",children:["Client",e.jsx(o,{size:"lg",className:n("client"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("quotation_date"),className:"cursor-pointer text-decoration-underline",children:["Quotation Date",e.jsx(o,{size:"lg",className:n("quotation_date"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("quotation_no"),className:"cursor-pointer text-decoration-underline",children:["Quotation No.",e.jsx(o,{size:"lg",className:n("quotation_no"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("end_user"),className:"cursor-pointer text-decoration-underline",children:["End User",e.jsx(o,{size:"lg",className:n("end_user"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("revision"),className:"cursor-pointer text-decoration-underline",children:["Revision",e.jsx(o,{size:"lg",className:n("revision"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("quotation_amount"),className:"cursor-pointer text-decoration-underline",children:["Quotation Amount",e.jsx(o,{size:"lg",className:n("quotation_amount"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("cost"),className:"cursor-pointer text-decoration-underline",children:["Cost",e.jsx(o,{size:"lg",className:n("cost"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("margin"),className:"cursor-pointer text-decoration-underline",children:["Margin",e.jsx(o,{size:"lg",className:n("margin"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("margin_percentage"),className:"cursor-pointer text-decoration-underline",children:["%",e.jsx(o,{size:"lg",className:n("margin_percentage"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("status"),className:"cursor-pointer text-decoration-underline",children:["Status",e.jsx(o,{size:"lg",className:n("status"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("site_location"),className:"cursor-pointer text-decoration-underline",children:["Site Location",e.jsx(o,{size:"lg",className:n("site_location"),icon:"FilterList"})]}),e.jsxs("th",{onClick:()=>a("building"),className:"cursor-pointer text-decoration-underline",children:["Building",e.jsx(o,{size:"lg",className:n("building"),icon:"FilterList"})]}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:X(N,m,g).map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:s.prepared_by}),e.jsx("td",{children:s.client}),e.jsx("td",{children:c.utc(`${s.quotation_date}`).local().format("DD-MM-YYYY HH:mm:ss")}),e.jsx("td",{children:s.quotation_no}),e.jsx("td",{children:s.end_user}),e.jsx("td",{children:s.revision}),e.jsx("td",{children:s.quotation_amount?s.quotation_amount.toFixed(2):null}),e.jsx("td",{children:s.cost?s.cost.toFixed(2):null}),e.jsx("td",{children:s.quotation_amount&&s.cost?ee(s.cost,s.quotation_amount):null}),e.jsx("td",{children:s.quotation_amount&&s.cost?se(s.cost,s.quotation_amount):null}),e.jsx("td",{children:e.jsx(W,{className:"statusBadge",color:ne(s.status),children:e.jsx("h6",{children:s.status})})}),e.jsx("td",{children:s.site_location}),e.jsx("td",{children:s.building}),e.jsx("td",{children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-auto",children:e.jsx(h,{color:"primary",icon:"RemoveRedEye",shadow:"none",hoverShadow:"lg",tag:"a",hidden:!(i!=null&&i.view_quotation),onClick:()=>w(s.quotation_rev_id)})}),e.jsx("div",{className:"col-auto",children:e.jsx(h,{color:"primary",icon:"Edit",shadow:"none",hoverShadow:"lg",tag:"a",hidden:!(i!=null&&i.write_quotation),onClick:()=>F(s.quotation_rev_id)})})]})})]},s.id))})]})})]})}),e.jsx(Z,{data:N,label:"items",setCurrentPage:S,currentPage:m,perPage:g,setPerPage:f})]})]})]})};export{he as default};
